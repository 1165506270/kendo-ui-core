<!DOCTYPE html>
<html class="noHTML5">
<head>
    <meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport" />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <link rel="shortcut icon" href="favicon.ico">
    <link rel="apple-touch-icon-precomposed" href="img/touch-icon-57-precomposed.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/touch-icon-72-precomposed.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/touch-icon-114-precomposed.png" />
    <link rel="apple-touch-startup-image" href="img/splash.png" />

    <meta charset="utf-8" />

    <title>AeroViewr</title>
    <link rel="stylesheet" href="site.css" />
    <script type="text/javascript">
        (function(window){
            window.application = function() {
                this.IMAGESIZES = [
                    {suffix: "_s", size: 75},
                    {suffix: "_t", size: 100},
                    {suffix: "_m", size: 240}
                ],
                this.imageSize = this.IMAGESIZES[0],
                this.PAGESIZE = 300,
                this.template = function(option) { return '<li style="width:' + option.size + 'px;height:' + option.size + 'px"><img data-photoid="<#= id #>" alt="<#= kendo.htmlEncode(title) #>" src="http://farm<#=farm#>.static.flickr.com/<#=server#>/<#=id#>_<#=secret#>' + option.suffix + '.jpg"></li>'; },
                this.setTemplate = '<li data-setid="<#=id#>" alt="<#= kendo.htmlEncode(title._content) #>"><img width="75" height="75" src="http://farm<#=farm#>.static.flickr.com/<#=server#>/<#=primary#>_<#=secret#>_s.jpg"><em><#= kendo.htmlEncode(title._content) #></em></li>',
                this.EXTRAS = "owner_name,tags",
                this.flashArrows = 0,
                this.zoomFactor = 1,
                this.animType = false,
                this.scrollerOptions = {
                    zoomFactor: this.zoomFactor,
                    showArrow: function(arrow) {
                        if (flashArrows++ < 2) {
                            var direction = arrow.hasClass('left-scroll-arrow') ? 'left' : 'right',
                                away = {}, back = {};

                            away[direction] = '-7px';
                            back[direction] = 0;

                            for (var i=0;i++<2;)
                                arrow
                                    .animate(away, 100)
                                    .animate(back, 100);
                        }
                    }
                },
                this.computePageSize = function(size, onlyHeight) {
                    var pagerHeight = 56,
                        staticHeight = $("header").height() + $("#footer").height() + pagerHeight,
                        widthMargin = $("#main").outerHeight(true) - $("#main").outerHeight(),
                        width = window.innerWidth - widthMargin,
                        height = window.innerHeight - staticHeight,
                        imagesOnHeight = parseInt(height/size) || 1;

                    return onlyHeight ? imagesOnHeight : imagesOnHeight * parseInt(width/size);
                },
                this.hideExif = function() {
                    var exifWindow = $("#exifWindow");
                    if (exifWindow.length) {
                        exifWindow.data("kendoWindow").close();
                    }
                },
                this.searchDeserializer = {
                    data: function(result) {
                        return result.photos.photo;
                    },
                    total: function(result) {
                        return Math.min(result.photos.total, PAGESIZE);
                    }
                },
                this.displayImages = function(element) {
                    element.find("img")
                        .hide()
                        .bind("load", function() {
                            $(this).stop(true, true).fadeIn();
                        });
                },
                this.loadingTimeout = 0,
                this.setBigPhoto = function(img) {
                    var bigPhoto = $("#bigPhoto"),
                        wrap = $('#photoWrap'),
                        src = img.attr("src").replace("_s", "").replace(imageSize.suffix,""),
                        loader = $("img.loader"),
                        exifInfo = $(".exifInfo");

                    bigPhoto.attr("data-photoid", img.attr("data-photoid"));

                    if (loader.length) {
                        loader.remove();
                    } else {
                        loadingTimeout = setTimeout(function() {
                            wrap.after("<div class='loading'>Loading ...</div>");
                            exifInfo.fadeOut();
                        }, 100);
                    }

                    loader = $("<img class='loader' />")
                        .hide()
                        .appendTo(document.body)
                        .attr("src", src)
                        .bind("load", function() {
                            clearTimeout(loadingTimeout);

                            loader.remove();

                            wrap.next(".loading")
                                .remove();

                            if (!slideshow._started){
                               bigPhoto = bigPhoto.add(exifInfo);
                            }

                            bigPhoto.stop(true, true)
                                .fadeOut(function() {
                                    if (exifInfo.length && this == exifInfo[0]) {
                                        var photoid = exifInfo.attr("data-photoid");
                                        exifInfo.find("h2")
                                           .text(img.attr("alt") || "No Title")
                                           .end()
                                           .attr("data-photoid", img.attr("data-photoid"));
                                        exifInfo.css({
                                           display: 'block',
                                           opacity: photoid === img.attr("data-photoid") ? 1 : 0
                                        });
                                    } else {
                                        bigPhoto.attr("src", src);
                                        exifInfo.css({
                                           display: 'block',
                                           opacity: 1
                                        });

                                    }
                                });

                            var first = true;
                            bigPhoto.fadeIn({
                                step: function (now) {
                                    if (first && animType) {
                                        $('#photoWrap').kendoAnimate(animType, 400, true);
                                        first = animType = false;
                                    }

                                    if (!slideshow._started)
                                        exifInfo.css('opacity',  now);
                                }
                            });

                        });
                }
            };
        })(window);
    </script>
    <!-- jquery -->
    <script src="../../src/jquery.js"></script>
    <!-- jquery -->
    <!-- kendo -->
    <script src="../../src/kendo.core.js"></script>
    <script src="../../src/kendo.fx.js"></script>
    <script src="../../src/kendo.data.js"></script>
    <script src="../../src/kendo.pageable.js"></script>
    <script src="../../src/kendo.selectable.js"></script>
    <script src="../../src/kendo.draganddrop.js"></script>
    <script src="../../src/kendo.sortable.js"></script>
    <script src="../../src/kendo.listView.js"></script>
    <script src="../../src/kendo.grid.js"></script>
    <script src="../../src/kendo.slider.js"></script>
    <script src="../../src/kendo.popup.js"></script>
    <script src="../../src/kendo.list.js"></script>
    <script src="../../src/kendo.autocomplete.js"></script>
    <script src="../../src/kendo.upload.js"></script>
    <script src="../../src/kendo.scroller.js"></script>
    <script src="../../src/kendo.window.js"></script>
    <!-- kendo -->
    <script src="js/md5.js"></script>
    <!-- aeroviewr -->
    <script src="js/pincer.js"></script>
    <script src="js/data.js"></script>
    <script src="js/flickr.js"></script>
    <script src="js/slideshow.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/visitor.js"></script>
    <script src="js/user.js"></script>
    <script src="js/aeroviewr.js"></script>
    <!-- aeroviewr -->
</head>
<body>
    <div id="wrap">
        <header class="floatWrap">
            <h1><a href=".">Aero<strong>Viewr</strong></a></h1>
            <a id="signin" href="#" class="signin">Sign in</a>
            <span id="userInfo" class="signin" style="display:none">Signed in as <a href="http://www.flickr.com" ><em>MyUser</em></a>&nbsp;&nbsp;(<a id="signout" href="#"><em>sign out</em></a>)</span>
            <ul>
                <li><input placeholder="search" id="searchBox"/></li>
                <li><a href="#" class="p-icon i-search">Search</a></li>
                <li><a href="#" class="p-icon i-hints">Hints</a></li>
            </ul>
        </header>

        <section id="photoWrap">
            <div id="overlay" style="display:none;"><!-- --></div>
        </section>

        <section id="main">
            <div id="mainTemplate" style="display:none">
                <ul class="thumbViews"><li><button id="listView" class="p-border p-icon i-tileview">ListView layout</button></li><li><button id="grid" class="p-border p-icon i-gridview">Grid layout</button></li></ul>
                <div class="paging"></div>
                <ul id="mainPhotoStrip" class="floatWrap thumbs"><li><!-- --></li></ul>
                <input type="range" id="slider" />
                <table id="mainPhotoGrid"><tr><td><!-- --></td></tr></table>
            </div>
            <div id="mainUserWrap" style="display:none">
                <ul class="thumbViews"><li><button id="listViewNotInSetPhotos" class="p-border p-icon i-tileview">ListView layout</button></li><li><button id="gridNotInSetPhotos" class="p-border p-icon i-gridview">Grid layout</button></li></ul>
                <ol id="setPhotoPager" class="paging"></ol>
                <ul id="mainSetPhotoStrip" class="floatWrap thumbs"><li><!-- --></li></ul>
                <input type="range" id="setPhotoSize" style="display:none" />
                <table id="mainSetPhotoGrid"><tr><td><!-- --></td></tr></table>
            </div>
            <div id="uploadWrap"></div>
            <div id="exifButton" class="p-border-big exifInfo" title="view photo details"><h2>&nbsp;</h2><span class="p-border p-icon i-help"></span></div>
            <div id="noHTML5Alert">
                <p>Hello! Thank you for your interest in the AeroViewr demo. It showcases client components and some of the latest HTML5 and CSS3 capabilities,
                and works only on modern browsers.</p>
                <p>Please use Internet Explorer 9+, Mozilla Firefox 3.6+, Opera 10+, Chrome 10+, Safari 4+ or another compatible browser.</p><p>Javascript must be enabled.</p>
            </div>
            <div id="signInInfo" class="callout t-window" style="display: none;">
                <div></div>
                <p><span>Sign in</span> with your <span>Flickr</span> or <span>Yahoo</span> account, to see the entire app functionality</p>
            </div>
            <div id="searchInfo" class="callout t-window" style="display: none;">
                <div></div>
                <p><span>Type</span> something and <span>click search</span> button. You can also use related tags from the suggestion list.</p>
            </div>
        </section>

        <section id="footer">
            <a href="#" id="viewslideshow"><span class="p-border-big p-icon i-slideshow"></span><em>Play</em></a>
            <ul id="flatMostPopularPhotos" class="floatWrap thumbs"><li><!-- --></li></ul>
            <ul id="flatSearchPhotos" style="display:none" class="floatWrap thumbs"><li><!-- --></li></ul>
            <ul id="flatPhotoStrip" style="display:none" class="floatWrap thumbs"><li><!-- --></li></ul>
            <ul id="flatSetsStrip" style="display:none" class="floatWrap thumbs"><li><!-- --></li></ul>
            <a href="#" id="uploadphotos"><span class="p-border-big p-icon i-uploadphotos"></span><em>Upload</em></a>
            <a class="bottomLink" id="backButton" href="#"></a>
        </section>
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-23480938-1']);
            _gaq.push(['_setDomainName', '.kendoui.com']);
            _gaq.push(['_setAllowHash', false]);
            _gaq.push(['_trackPageview']);

            (function () {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </div>
</body>
</html>
