<!DOCTYPE html>
<html class="noHTML5"> 
<head>
    <!--<script src="http://192.168.61.28:8080/target/target-script-min.js"></script>-->
    <meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport" />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <link rel="shortcut icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="img/kendo.png" />
    <link rel="apple-touch-startup-image" href="img/splash.png" />

    <meta charset="utf-8" />

    <title>AeroViewr</title>
    <link rel="stylesheet" href="site.css" />
    <script type="text/javascript">
        (function(window){            
            window.application = function() {
                this.IMAGESIZES = [
                    {suffix: "_s", size: 75},
                    {suffix: "_t", size: 100},
                    {suffix: "_m", size: 240}
                ],
                this.imageSize = this.IMAGESIZES[0],
                this.PAGESIZE = 100,
                this.template = function(option) { return '<li style="width:' + option.size + 'px;height:' + option.size + 'px"><img data-photoid="<%= id %>" alt="<%= kendo.htmlEncode(title) %>" src="http://farm<%=farm%>.static.flickr.com/<%=server%>/<%=id%>_<%=secret%>' + option.suffix + '.jpg"></li>'; },
                this.setTemplate = '<li data-setid="<%=id%>" alt="<%= kendo.htmlEncode(title._content) %>"><img width="75" height="75" src="http://farm<%=farm%>.static.flickr.com/<%=server%>/<%=primary%>_<%=secret%>_s.jpg"><em><%= kendo.htmlEncode(title._content) %></em></li>',
                this.EXTRAS = "owner_name,tags",
                this.hideExif = function() {
                    var exifWindow = $("#exifWindow");
                    if (exifWindow[0]) {
                        exifWindow.data("kendoWindow").close();
                    }
                },
                this.searchReader = {
                    data: function(result) {
                        return result.photos.photo;
                    },
                    total: function(result) {                      
                        return Math.min(result.photos.total, PAGESIZE);
                    }
                },
                this.displayImages = function(element) {
                    element.find("img")
                        .hide()
                        .bind("load", function() {
                            $(this).fadeIn();
                        });
                },
                this.loadingTimeout = 0,
                this.setBigPhoto = function(img) {
                    var bigPhoto = $("#bigPhoto"),
                        wrap = $('#photoWrap'),
                        src = img.attr("src").replace("_s", "").replace(imageSize.suffix,""),
                        loader = $("img.loader"),
                        exifInfo = $(".exifInfo");

                    if (loader.length) {
                        loader.remove();
                    } else {
                        loadingTimeout = setTimeout(function() {
                            wrap.after("<div class='loading'>Loading ...</div>");
                            exifInfo.fadeOut();
                        }, 100);
                    }

                    loader = $("<img class='loader' />")
                        .hide()
                        .appendTo(document.body)
                        .attr("src", src)
                        .bind("load", function() {
                            clearTimeout(loadingTimeout);

                            loader.remove();

                            wrap.next(".loading")
                                .remove();

                            if (!slideshow._started){
                               bigPhoto = bigPhoto.add(exifInfo);
                            }

                            bigPhoto.stop(true, true)
                                .fadeOut(function() {
                                    if (this == exifInfo[0]) {
                                        exifInfo.find("h2")
                                           .text(img.attr("alt") || "No Title")
                                           .end()
                                           .attr("data-photoid", img.attr("data-photoid"));
                                        exifInfo.css({
                                           display: 'block',
                                           opacity: 0
                                        });
                                    } else {
                                        bigPhoto.attr("src", src);
                                    }
                                });

                            var first = true;
                            bigPhoto.fadeIn({
                                step: function (now) {
                                    if (first && animType) {
                                        $('#photoWrap').kendoAnimate(animType, 400, true);
                                        first = animType = false;
                                    }
                                    
                                    if (!slideshow._started)
                                        exifInfo.css('opacity',  now);
                                }
                            });

                        });
                }
            };            
        })(window);
    </script>
    <script src="js/md5.js"></script>
    <script src="../../src/jquery.js"></script>
    <script src="../../src/kendo.core.js"></script>
    <script src="../../src/kendo.fx.js"></script>
    <script src="../../src/kendo.query.js"></script>
    <script src="../../src/kendo.datasource.js"></script>
    <script src="../../src/kendo.pager.js"></script>
    <script src="../../src/kendo.selectable.js"></script>
    <script src="../../src/kendo.draganddrop.js"></script>
    <script src="../../src/kendo.sortable.js"></script>
    <script src="../../src/kendo.listView.js"></script>
    <script src="../../src/kendo.grid.js"></script>
    <script src="../../src/kendo.slider.js"></script>
    <script src="../../src/kendo.popup.js"></script>
    <script src="../../src/kendo.autocomplete.js"></script>
    <script src="../../src/kendo.upload.js"></script>
    <script src="../../src/kendo.scroller.js"></script>
    <script src="../../src/kendo.window.js"></script>

    <script src="js/data.js"></script>
    <script src="js/flickr.js"></script>
    <script src="js/slideshow.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/visitor.js"></script>
    <script src="js/user.js"></script>
    <script src="js/aeroviewr.js"></script>
</head>
<body>
    <div id="wrap">
        <header class="floatWrap">
            <h1>Aero<strong>Viewr</strong></h1>
            <a id="signin" href="#" class="signin">Sign in</a>
            <span id="userInfo" class="signin" style="display:none">Signed in as <a href="#" ><em>MyUser</em></a>&nbsp;&nbsp;(<a id="signout" href="#"><em>sign out</em></a>)</span>
            <ul>
                <li><input placeholder="search" id="searchBox"/></li>
                <li><a href="#" class="p-icon i-search">Search</a></li>
            </ul>
        </header>

        <section id="photoWrap">
            <img id="bigPhoto" alt="big photo" src="#" />
            <div id="overlay" style="display:none;"><!-- --></div>
        </section>

        <section id="main">
            <div id="mainTemplate" style="display:none">
                <ul class="thumbViews"><li><button id="listView" class="p-border p-icon i-tileview">ListView layout</button></li><li><button id="grid" class="p-border p-icon i-gridview">Grid layout</button></li></ul>
                <ol class="paging"><li><!-- --></li></ol>
                <ul id="mainPhotoStrip" class="floatWrap thumbs"><li><!-- --></li></ul>
                <input type="range" id="slider" />
                <table id="mainPhotoGrid"><tr><td><!-- --></td></tr></table>
            </div>
            <div id="mainUserWrap" style="display:none">
                <ul class="thumbViews"><li><button id="listViewNotInSetPhotos" class="p-border p-icon i-tileview">ListView layout</button></li><li><button id="gridNotInSetPhotos" class="p-border p-icon i-gridview">Grid layout</button></li></ul>
                <ol id="setPhotoPager" class="paging"><li><!-- --></li></ol>
                <ul id="mainSetPhotoStrip" class="floatWrap thumbs"><li><!-- --></li></ul>
                <input type="range" id="setPhotoSize" style="display:none" />
                <table id="mainSetPhotoGrid"><tr><td><!-- --></td></tr></table>
            </div>
            <div id="uploadWrap"></div>
            <div id="exifButton" class="p-border-big exifInfo" title="view photo details"><h2>&nbsp;</h2><span class="p-border p-icon i-help"></span></div>
            <div id="noHTML5Alert">
                <p>Hello! Thank you for your interest in the AeroViewr demo. It showcases client components and some of the latest HTML5 and CSS3 capabilities,
                and works only on modern browsers.</p>
                <p>Please use Internet Explorer 9+, Mozilla Firefox 3.6+, Opera 10+, Chrome 10+, Safari 4+ or another compatible browser.</p><p>Javascript must be enabled.</p>
            </div>
        </section>

        <section id="footer">
            <a href="#" id="viewslideshow"><span class="p-border-big p-icon i-slideshow"></span><em>Play</em></a>
            <ul id="flatMostPopularPhotos" class="floatWrap thumbs"><li><!-- --></li></ul>
            <ul id="flatSearchPhotos" style="display:none" class="floatWrap thumbs"><li><!-- --></li></ul>
            <ul id="flatPhotoStrip" style="display:none" class="floatWrap thumbs"><li><!-- --></li></ul>
            <ul id="flatSetsStrip" style="display:none" class="floatWrap thumbs"><li><!-- --></li></ul>
            <a href="#" id="uploadphotos"><span class="p-border-big p-icon i-uploadphotos"></span><em>Upload</em></a>
            <a class="bottomLink" id="backButton" href="#"></a>
        </section>
    </div>
</body>
</html>
