<!doctype html>
<html>
    <head>
        <!-- meta -->
        <!-- meta -->
        <title>Remote data operations</title>
        <!-- css -->
        <link href="../styles/examples.css" rel="stylesheet"/>
        <link href="../../../styles/kendo.common.css" rel="stylesheet"/>
        <link href="../../../styles/kendo.kendo.css" rel="stylesheet"/>
        <!-- css -->
        <!-- script -->
        <script src="../../../src/jquery.js"></script>
        <script src="../../../src/kendo.core.js"></script>
        <script src="../../../src/kendo.data.js"></script>
        <script src="../../../src/kendo.data.odata.js"></script>
        <!-- script -->
    </head>
    <body>
        <!-- nav -->
        <!-- nav -->
        <!-- description -->
        <div class="description">Remote data operations</div>
        <!-- description -->
        <div id="example" class="t-content">

            <div id="movies-container" class="t-widget t-header">
                <ul id="movies"</ul>
            </div>

            <script id="template" type="text/x-kendo-template">
                <li class="title">
                    <# if (BoxArt.LargeUrl) { #>
                        <img src="<#= BoxArt.LargeUrl #>" />
                    <# } #>
                    <dl>
                        <dt>Name:</dt>
                        <dd><#= Name #></dd>
                        <dt>Average Rating:</dt>
                        <dd><#= AverageRating #></dd>
                    </dl>
                </li>
            </script>

            <script>
                // create a template using the above definition
                var template = kendo.template($("#template").html());

                var dataSource = new kendo.data.DataSource({
                    type: "odata",
                    serverPaging: true,
                    serverSorting: true,
                    pageSize: 10,
                    transport: {
                        read: "http://odata.netflix.com/Catalog/Titles"
                    },
                    change: function() { // subscribe to the CHANGE event of the data source
                        // update the max attribute of the "page" input
                        $("#page").attr("max", this.totalPages());

                        $("#movies").html(kendo.render(template, this.view()));
                    }
                });

                // read data from the remote service
                dataSource.read();

                $("#apply").click(function() {
                    var page = parseInt($("#page").val(), 10);

                    // validate the page - it must be a number within the allowed range
                    if (isNaN(page) || page < 1 || page > dataSource.totalPages()) {
                        alert(kendo.format("Page must be a number between 1 and {0}", dataSource.totalPages()));
                        return;
                    }

                    // query the remote service
                    dataSource.query({
                        page: page,
                        pageSize: 10,
                        sort: {
                            field: $("#order").val(),
                            dir:$("#dir").val()
                        }
                    });
                });
            </script>

            <div class="configuration">
                <span class="configHead">Configure</span>
                <ul class="options">
                    <li>
                        <label for="page">Page:</label>
                        <input type="number" value="1" id="page" min="1" />
                    </li>
                    <li>
                        <label for="order">Order by:</label>
                        <select id="order">
                            <option value="Id">Id</option>
                            <option value="Name">Name</option>
                            <option value="AverageRating">Average Rating</option>
                            <option value="ReleaseYear">Release Year</option>
                        </select>
                    </li>
                    <li>
                        <label for="dir">Direction:</label>
                        <select id="dir">
                            <option value="asc">Ascending</option>
                            <option value="desc">Descending</option>
                        </select>
                    </li>
                    <li>
                        <button class="t-button" id="apply">Apply</button>
                    </li>
                </ul>
            </div>

            <style scoped>
                #movies-container {
                    padding: 10px;
                    overflow: auto;
                    height: 400px;
                    margin: 0 300px 0 0;
                    border-radius: 5px;
                }

                #movies {
                    padding: 0;
                    height: 410px;
                }

                .title {
                    float: left;
                    width: 200px;
                    list-style-type: none;
                    margin: 0 0 20px;
                    padding: 5px;
                    width: 300px;
                    height: 110px;
                    overflow: hidden;
                }

                .title img {
                    float: left;
                    border-radius: 3px;
                    box-shadow: 0 0 5px #ccc;
                }
            </style>
        </div>
        <!-- tools -->
        <!-- tools -->
    </body>
</html>

