@{
    // WebKit's back button caches ajax responses so we are not relying on IsAjaxRequest

    if (Request.Params.AllKeys.Contains("nav"))
    {
        Layout = "~/Views/Shared/_LayoutWidget.cshtml";
    }
    else if (!Request.Params.AllKeys.Contains("partial"))
    {
        Layout = "~/Views/Shared/_Layout.cshtml";
    }
}
<div id="main">
    <h1 id="exampleTitle">
        @if (ViewBag.CurrentExample != null) {
            <span class="exampleIcon @ViewBag.CurrentWidget.SpriteCssClass"></span>
            <strong>@ViewBag.CurrentWidget.Text @(ViewBag.CurrentExample.Url.Contains("dashboard") ? "" : "/")</strong> @ViewBag.CurrentExample.Text
        }
    </h1>

    <div id="theme-list-container"></div>

    <div id="exampleWrap">
        <script>preventFOUC()</script>

        @if (ViewBag.suite == "mobile") {
        <div id="example" class="k-content mobileExample @(ViewBag.CurrentWidget.Tablet ? "tablet km-tablet" : "")">

            <div id="device-wrapper">
                <div id="mobile-application-container">
                    @RenderBody()
                    <div data-role="layout" data-id="examples">
                        <header data-role="header">
                            <div data-role="navbar">
                                <!--a class="nav-button" data-align="left" data-role="backbutton">Back</a-->
                                <span data-role="view-title"></span>
                                <a data-align="right" data-role="button" class="nav-button" href="#/">Index</a>
                            </div>
                        </header>
                    </div>
                </div>
            </div>

            @RenderSection("ExampleFooter", false)
        </div>
        <script>
            if ((kendo.support.browser.msie && kendo.support.browser.version < 10) || kendo.support.browser.opera) {
                $("#mobile-application-container")
                        .addClass("old-browser")
                        .empty()
                        .html("<div class='content'><span class='centered'><strong>Kendo UI Mobile</strong><span>is fully supported only in WebKit based browsers and IE10.</span><br><br>Please use a compatible desktop browser or open the examples in a mobile WebKit based browser or Windows Phone.</span></div>");
            }
        </script>
        } else {
            @RenderBody()
        }
    </div>

    @if (ViewBag.ShowCodeStrip == true)
    {
        <button class="try-kendo"><span class="k-icon"></span>Edit this example</button>
        <div id="codeStrip">
            @if (!string.IsNullOrEmpty(ViewBag.Documentation))
            {
                <a class="documentation-link k-link" href="http://docs.telerik.com/kendo-ui/api/@ViewBag.Documentation">Documentation</a>
            }

            <ul>
                @foreach (ExampleFramework framework in ViewBag.Frameworks)
                {
                    <li>@framework.Name</li>
                }
            </ul>
            @foreach (ExampleFramework framework in ViewBag.Frameworks)
            {
               <div id="@framework.Name.Replace(".", "-").Replace(" ", "-")">
               <ul>
                    @foreach (ExampleFile file in framework.Files)
                    {
                        <li>@file.Name</li>
                    }
               </ul>
               </div>
               <script>
               var minHeightFlag = false;
               $("#@framework.Name.Replace(".", "-").Replace(" ", "-")").kendoTabStrip({
                    animation: {
                        open: {
                            effects: "fadeIn"
                        }
                    },
                    contentUrls: [
                        @Html.Raw(String.Join(",", framework.Files.Select(file => "\"" + Url.Action("index", "source", new { path = file.Url } ) + "\"").ToArray()))
                    ],
                    contentLoad: function (e) {
                        var baseUrl = "http://@(Request.Headers["host"] + Url.Content("~/"))";
                        var content = $(e.contentElement);
                        if (content.is("#HTML-1")) {
                            var html = content.find('.prettyprint').text();
                            content.data("html", content.find('.prettyprint').text());
                        }

                        prettyPrint();
                        if (!minHeightFlag) {
                            var cs = $("#codeStrip");
                            cs.css("min-height", cs.height());
                        }
                    }
               });

                   dojo.configuration = {
                       url: "@Html.ScratchpadRoot()",
                       cdnRoot: '@Html.CdnRoot()'
                   };
               </script>
            }
        </div>

        <script>
            (function () {
                var codeviewer = $("#codeStrip");
                var selectedTabIndex = tabToSelect();

                if (codeviewer.find(">ul>li").length - 1 < selectedTabIndex) {
                    selectedTabIndex = 0;
                }

                codeviewer.kendoTabStrip({
                    animation: {
                        open: {
                            effects: "fadeIn"
                        }
                    },
                    select: function (e) {
                        var tabstrip = $(e.contentElement).data("kendoTabStrip");
                        if (tabstrip.select().length == 0) {
                            tabstrip.select(0);
                        }
                    },
                    activate: function (e) {
                        var isHtml = $(e.contentElement).is("#codeStrip-1");
                        $(".try-kendo").toggleClass("k-state-disabled", !isHtml).prop('disabled', !isHtml);
                    }
                })
                .data("kendoTabStrip")
                .select(selectedTabIndex);
            } ());
        </script>
    }
</div>

<script>
    setTimeout(function(){ prettyPrint(); }, 100);

    document.title = "@Html.Raw(ViewBag.Title)";

    @if (ViewBag.suite == "mobile")
    {
        <text>
            kendo.history.stop();

            $(function() {
                applyCurrentMobileOS("#mobile-application-container");
                var skin = kendoMobileOS != "flat" ? {} : {
                        platform: "ios7",
                        skin: "flat"
                    };

                if (!(kendo.support.browser.msie && kendo.support.browser.version < 10) && !kendo.support.browser.opera) {
                    window.app = new kendo.mobile.Application($("#mobile-application-container"),
                        $.extend({
                            layout: "examples",
                            platform: kendoMobileOS,
                            updateDocumentTitle: false,
                            hideAddressBar: false
                        }, skin));
                }
            });
        </text>
    }
</script>
