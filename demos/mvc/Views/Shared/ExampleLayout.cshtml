@{
    // WebKit's back button caches ajax responses so we are not relying on IsAjaxRequest

    if (!Request.Params.AllKeys.Contains("partial"))
    {
        Layout = "~/Views/Shared/_Layout.cshtml";
    }
}

<div id="main">
    <h1 id="exampleTitle" class="k-content">
        @if (ViewBag.CurrentExample != null) {
            <span class="exampleIcon @ViewBag.CurrentWidget.SpriteCssClass"></span>
            @ViewBag.CurrentWidget.Text / @ViewBag.CurrentExample.Text
        }
    </h1>

    <div id="exampleWrap">
        <script>preventFOUC()</script>

        @if (ViewBag.suite == "mobile") {
        <div id="example" class="k-content mobileExample">

            <div class="configuration mobileConfiguration">
                <a class="bigButton" id="downloadMobile" href="http://www.kendoui.com/account/your-products/trial-product-versions/trial-single-download.aspx?pid=949"><strong>Download Beta</strong> <em>Get Kendo UI Mobile Beta</em></a>
                <input id="deviceChooser" type="hidden" />
                <ul id="deviceList" class="options">
                    <li></li>
                </ul>
                <p id="qrWrap">Open this demo with an iOS/Android mobile device for a full experience. <a href="#" id="qr"><span class="k-icon k-qr"></span><em>Show QR Code</em></a></p>
                <img src="@Url.Content("~/content/mobile/shared/qr.png")" id="qrBig" />

                <script id="deviceThumbTemplate" type="text/x-kendo-template">
                    <li><span class="thumbLink"><span class="thumb #= value #Thumb">#= value #</span><span class="skinTitle"><em>#= text #</em> Simulator</span></span></li>
                </script>

            </div>

            <div id="device-wrapper">
                <div id="mobile-application-container">
                    @RenderBody()
                    <div data-role="layout" data-id="examples">
                        <header data-role="header">
                            <div data-role="navbar">
                                <!--a class="nav-button" data-align="left" data-role="backbutton">Back</a-->
                                <span data-role="view-title">Settings</span>
                                <a data-align="right" data-role="button" class="nav-button" href="#index">Index</a>
                            </div>
                        </header>
                    </div>
                </div>
            </div>

            @RenderSection("ExampleFooter", false)
        </div>
        <script>
            if (!($.browser.webkit || $.browser.mozilla)) {
                $("#mobile-application-container")
                        .addClass("old-browser")
                        .empty()
                        .html("<div class='content'><span class='centered'><strong>Kendo UI Mobile</strong><span>is fully supported only in WebKit based browsers and partially supported in Firefox.</span><br><br>Please use a compatible desktop browser or open the examples in a mobile WebKit based browser.</span></div>");
            }
        </script>
        } else {
            @RenderBody()
        }
    </div>

    @if (ViewBag.ShowCodeStrip == true)
    {
        <div id="codeStrip">
            <ul>
                <li class="k-state-active">Description</li>
                <li>View Code</li>

                @if (ViewBag.ConfigurationDocPath != null)
                {
                    <li>Configuration</li>
                }

                @if (ViewBag.MethodsDocPath != null)
                {
                    <li>Methods</li>
                }

                @if (ViewBag.EventsDocPath != null)
                {
                    <li>Events</li>
                }
            </ul>
            <div class="description">
                @Html.Raw(ViewBag.Description)
                @RenderSection("Description", false)
            </div>
        </div>

        <script>
            $("#codeStrip").kendoTabStrip({
                contentUrls: [null,
                    "@Url.RouteUrl("Source", new { suite = ViewBag.suite, section = ViewBag.Section, example = ViewBag.Example })"
                    @if (ViewBag.ConfigurationDocPath != null)
                    {
                        <text>
                        ,"@Url.ContentOrEmpty((string) ViewBag.ConfigurationDocPath)"
                        </text>
                    }
                    @if (ViewBag.MethodsDocPath != null)
                    {
                        <text>
                        ,"@Url.ContentOrEmpty((string) ViewBag.MethodsDocPath)"
                        </text>
                    }
                    @if (ViewBag.EventsDocPath != null)
                    {
                        <text>
                        ,"@Url.ContentOrEmpty((string) ViewBag.EventsDocPath)"
                        </text>
                    }
                ],
                contentLoad: function() {
                    prettyPrint();
                }
            });
        </script>
    }
</div>

<script>
    setTimeout(function(){ prettyPrint(); }, 100);

    document.title = "@Html.Raw(ViewBag.Title)";

    @if (ViewBag.suite == "mobile")
    {
        <text>
            kendo.history.stop();

            $(function() {
                applyCurrentMobileOS("#mobile-application-container");

                window.kendoMobileApplication = new kendo.mobile.Application($("#mobile-application-container"),
                {
                    layout: "examples",
                    platform: kendoMobileOS
                });
            });
        </text>
    }
    else
    {
        <text>
            applyCurrentTheme();
        </text>
    }
</script>
