<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="../dist/styles/web/kendo.common.css" />
    <link rel="stylesheet" href="../dist/styles/web/kendo.default.css" />
    <script src="html2canvas.min.js"></script>
    <script src="loader.js"></script>
    <script>
      requireSync([
        "../src/jquery.js",
        "../src/kendo.all.js",
        "./console.time.js"
      ]);
    </script>

    <!-- <script src="./pako.min.js"></script> -->

    <script>
        kendo.pdf.defineFont({
            "Verdana"             : "./Verdana/Verdana.ttf",
            "Verdana|Bold"        : "./Verdana/Verdana_Bold.ttf",
            "Verdana|Bold|Italic" : "./Verdana/Verdana_Bold_Italic.ttf",
            "Verdana|Italic"      : "./Verdana/Verdana_Italic.ttf"
        });
    </script>

    <style>
      body {
        margin: 0; padding: 1em;
        font-size: 12px;
        font-family: Verdana;
      }
      .k-widget, button {
        font-family: Verdana !important;
      }
    </style>
  </head>
  <body>

    Kendo:
    <button onclick="pdf('#test1')">PDF</button>
    <button onclick="draw('#test1', 'svg')">SVG</button>
    <button onclick="draw('#test1', 'canvas')">Canvas</button>
    |
    <button onclick="h2c('#test1')">html2canvas</button>

    <div id="test1" style="margin: 2em; max-width: 590px">
      <div id="scheduler"></div>
    </div>

    <script>
$(function() {
    $("#scheduler").kendoScheduler({
        date: new Date("2013/6/13"),
        startTime: new Date("2013/6/13 07:00 AM"),
        height: 600,
        views: [
            "day",
            { type: "workWeek", selected: true },
            "week",
            "month",
            "agenda"
        ],
        timezone: "Etc/UTC",
        dataSource: {
            batch: true,
            transport: {
                read: {
                    url: "http://demos.telerik.com/kendo-ui/service/tasks",
                    dataType: "jsonp"
                },
                update: {
                    url: "http://demos.telerik.com/kendo-ui/service/tasks/update",
                    dataType: "jsonp"
                },
                create: {
                    url: "http://demos.telerik.com/kendo-ui/service/tasks/create",
                    dataType: "jsonp"
                },
                destroy: {
                    url: "http://demos.telerik.com/kendo-ui/service/tasks/destroy",
                    dataType: "jsonp"
                },
                parameterMap: function(options, operation) {
                    if (operation !== "read" && options.models) {
                        return {models: kendo.stringify(options.models)};
                    }
                }
            },
            schema: {
                model: {
                    id: "taskId",
                    fields: {
                        taskId: { from: "TaskID", type: "number" },
                        title: { from: "Title", defaultValue: "No title", validation: { required: true } },
                        start: { type: "date", from: "Start" },
                        end: { type: "date", from: "End" },
                        startTimezone: { from: "StartTimezone" },
                        endTimezone: { from: "EndTimezone" },
                        description: { from: "Description" },
                        recurrenceId: { from: "RecurrenceID" },
                        recurrenceRule: { from: "RecurrenceRule" },
                        recurrenceException: { from: "RecurrenceException" },
                        ownerId: { from: "OwnerID", defaultValue: 1 },
                        isAllDay: { type: "boolean", from: "IsAllDay" }
                    }
                }
            },
            filter: {
                logic: "or",
                filters: [
                    { field: "ownerId", operator: "eq", value: 1 },
                    { field: "ownerId", operator: "eq", value: 2 }
                ]
            }
        },
        resources: [
            {
                field: "ownerId",
                title: "Owner",
                dataSource: [
                    { text: "Alex", value: 1, color: "#f8a398" },
                    { text: "Bob", value: 2, color: "#51a0ed" },
                    { text: "Charlie", value: 3, color: "#56ca85" }
                ]
            }
        ]
    });
});

      function container() {
        $(".surface").remove();
        return $("<div class='surface' style='position: absolute; background: white; box-sizing: border-box; right: 0; top: 0; bottom: 0; border: 1px solid #000; width: 600px'></div>").appendTo(document.body);
      }

      function draw(sel, type) {
        var el = $(sel)[0];
        console.time("drawing");
        kendo.dataviz.drawing.drawDOM(el, function(root){
          console.timeEnd("drawing");
          var surface = kendo.dataviz.drawing.Surface.create(container(), { type: type || "svg" });
          surface.draw(root);
        });
      }

      function pdf(sel) {
        var el = $(sel)[0];
        console.time("pdf");
        kendo.dataviz.drawing.drawDOM(el, function(root){
          kendo.dataviz.drawing.pdf.saveAs(root, "html-to-pdf4.pdf", "http://kendo.local:7569/", function(){
            console.timeEnd("pdf");
          });
        });
      }

      function h2c(sel) {
        console.time("html2canvas");
        html2canvas($(sel)[0]).then(function(canvas){
          console.timeEnd("html2canvas");
          container().append(canvas);
        });
      }
    </script>

  </body>
</html>
