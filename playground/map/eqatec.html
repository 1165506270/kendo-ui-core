<!DOCTYPE html>
<html>
<head>
    <title>Map sandbox</title>
    <meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <link rel="stylesheet/less" type="text/css" href="../../styles/web/kendo.common.less" />
    <link rel="stylesheet/less" type="text/css" href="../../styles/web/kendo.default.less" />
    <link rel="stylesheet/less" type="text/css" href="../../styles/dataviz/kendo.dataviz.less" />
    <link rel="stylesheet/less" type="text/css" href="../../styles/dataviz/kendo.dataviz.default.less" />
    <style>
        #map {
            width: 800px;
            height: 600px;
        }
    </style>
    <script src="../../demos/mvc/content/shared/js/less.js"></script>
    <script src="../require.js"></script>
    <script src="chroma.min.js"></script>
    <script>
      require.config({
          baseUrl: "../../src",
          paths: {
              cultures: "cultures",
          }
      });
    </script>
</head>
<body>
    <div id="map"></div>
    <button id="show">Show</button>
    <button id="hide">Hide</button>
    <script>
    var map;
    require([ "jquery.min", "kendo.dataviz.map" ], function(){
        var scale = chroma
            .scale(["white", "green"])
            .domain([1, 1000]);

        function setColor(shape, users) {
            if (shape.children) {
                for (var i = 0; i < shape.children.length; i++) {
                    setColor(shape.children[i], users);
                }
            } else if (shape.options) {
                var color = scale(users).hex();
                shape.fill(color);
            }
        }

        $("#map").kendoMap({
            center: [51.505, -0.09],
            zoom: 3,
            controls: {
                navigator: true, // boolean, object
                navigator: {
                    position: "topLeft" // "topRight", "bottomLeft", "bottomRight"
                },
                zoom: true, // boolean, object
                scale: true, // boolean, object
                birdsEyeView: true // miniMap? boolean, object
            },
            theme: "default",
            layers: [{
                dataSource: {
                    type: "geojson",
                    transport: {
                        read: "countries.geo.json"
                    }
                },
                style: {
                    fill: {
                        color: "#cf0",
                        opacity: 0.5
                    }
                },
                copyright: "&copy; FooBar"
            }, {
                dataSource: {
                    type: "geojson",
                    transport: {
                        read: "countries.geo.json"
                    }
                },
                coverage: [{
                    extent: [
                        45.3444, 20.8960, /* NW */
                        40.5222, 29.6850  /* SE */
                    ],
                    minZoom: 5,
                    maxZoom: 10
                }],
                style: {
                    fill: {
                        color: "red",
                        opacity: 0.5
                    }
                }
            }],
            markers: [{
                position: [51.5, -0.09],
                tooltip: {
                    // Nested tooltip configuration
                    // content: "Marker",
                    // autoHide: false,
                    // height: 
                    // width:
                    // position: "top",
                    // showAfter
                    // showOn
                }
            }],

            // Events
            click: function(e) {
                //console.log(e.location.toString());
            },
            markerCreated: $.noop,
            markerHover: $.noop,
            shapeClick: function(e) {
                e.shape.fill("blue");
            },
            shapeCreated: function(e) {
                var users = e.shape.dataItem.properties.users;
                if (users) {
                    setColor(e.shape, users);
                }
            },
            shapeMouseEnter: function(e) {
                var fill = e.shape.options.fill;
                if (fill) {
                    e.shape.oldColor = fill.color;
                    e.shape.options.set("fill.color", "red");
                }
            },
            shapeMouseLeave: function(e) {
                if (e.shape.oldColor) {
                    e.shape.options.set("fill.color", e.shape.oldColor);
                }
            },
            zoomEnd: function(e) {
                //console.log(e.sender.toScreenPoint(e.sender.center()).toString());
            }
        });

        map = $("#map").data("kendoMap");

        function flip() {
            var size = map.getSize();
            $("#map").css({
                width: size.height + "px",
                height: size.width + "px"
            });

            map.resize();
        }

        $("#show").click(function() {
            map.layers[0].show();
        });

        $("#hide").click(function() {
            map.layers[0].hide();
        });
    });
    </script>
</body>
</html>

 
