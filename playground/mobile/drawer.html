<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Drawer Proof of concept</title>
        <link rel="stylesheet/less" href="../../styles/mobile/kendo.mobile.ios.less">
        <script src="../../demos/mvc/content/shared/js/less.js"></script>
        <script src="../../src/jquery.min.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.router.js"></script>
        <script src="../../src/kendo.data.js"></script>
        <script src="../../src/kendo.binder.js"></script>
        <script src="../../src/kendo.fx.js"></script>
        <script src="../../src/kendo.draganddrop.js"></script>
        <script src="../../src/kendo.mobile.scroller.js"></script>
        <script src="../../src/kendo.mobile.navbar.js"></script>
        <script src="../../src/kendo.mobile.view.js"></script>
        <script src="../../src/kendo.mobile.button.js"></script>
        <script src="../../src/kendo.userevents.js"></script>
        <script src="../../src/kendo.mobile.loader.js"></script>
        <script src="../../src/kendo.mobile.pane.js"></script>
        <script src="../../src/kendo.mobile.application.js"></script>
        <script src="../../src/kendo.mobile.listview.js"></script>
        <script src="../../src/kendo.mobile.modalview.js"></script>
</head>
<body>
    <div data-role="view" data-init="attachDrawer">
        <a data-role="button">Foo</a>
        <ul data-role="listview">
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
            <li>Item 1</li>
        </ul>

    </div>
    <script type="text/javascript">
        var Transition = kendo.effects.Transition;

        function attachDrawer(e) {
            var el = e.view.element;

            var m = new kendo.ui.Movable(el);

            var t = new Transition({
                axis: "x",
                movable: m
            });

            var u = new kendo.UserEvents(el, {
                start: function(e) {
                    console.log('start drawer!', e);
                },

                move: function(e) {
                    m.translateAxis('x', e.x.delta);
                },

                end: function(e) {
                    var velocity = e.x.velocity,
                        width = el[0].offsetWidth,
                        threshold = width / 2,
                        velocityThreshold = 0.8,
                        location = 0;

                    if (velocity > -velocityThreshold && (velocity > velocityThreshold || m.x > width / 2)) {
                        location = width * 0.8;
                    }

                    t.moveTo({ location: location, duration: 300, ease: Transition.easeOutExpo });
                }
            });

            console.log(u);
        }
        new kendo.mobile.Application();
    </script>
</body>
</html>
