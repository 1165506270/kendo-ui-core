<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <link rel="stylesheet/less" href="../../styles/mobile/kendo.mobile.ios.less">
        <script src="../../demos/mvc/content/shared/js/less.js"></script>
        <script src="../../src/jquery.min.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.router.js"></script>
        <script src="../../src/kendo.data.js"></script>
        <script src="../../src/kendo.binder.js"></script>
        <script src="../../src/kendo.fx.js"></script>
        <script src="../../src/kendo.draganddrop.js"></script>
        <script src="../../src/kendo.mobile.scroller.js"></script>
        <script src="../../src/kendo.mobile.navbar.js"></script>
        <script src="../../src/kendo.mobile.view.js"></script>
        <script src="../../src/kendo.mobile.button.js"></script>
        <script src="../../src/kendo.userevents.js"></script>
        <script src="../../src/kendo.mobile.loader.js"></script>
        <script src="../../src/kendo.mobile.pane.js"></script>
        <script src="../../src/kendo.mobile.application.js"></script>
        <script src="../../src/kendo.mobile.listview.js"></script>
        <script src="../../src/kendo.mobile.modalview.js"></script>
    </head>
    <body>
        <div id="boatsView" data-role="view" data-title="Boats" data-model="LunchBoat.boatsViewModel">
            <ul class="boat-list" data-bind="source: boats" data-style="inset" data-role="listview" data-template="boat-template"></ul>
        </div>

        <script id="boat-template" type="text/x-kendo-template">
            #= boatId #
            <h2 class="destination" data-bind="text: destination"></h2>
            <ul data-role="listview" data-bind="source: crewMembers" class="crew-member-list" data-template="crew-member-template"></ul>
            <ul data-role="listview" class="crew-member-list">
                <li>
                    <button data-role="button" data-click="LunchBoat.addSelfToBoat" data-boat-id="#= data.boatId #">+</button>
                </li>
            </ul>
        </script>

        <script id="crew-member-template" type="text/x-kendo-template">
            <span class="crew-member" data-bind="text: name"></span>
        </script>

        <script>
            var Boat = kendo.data.Model.define({
                id: "boatId",
                fields: {
                    destination: {
                        type: "string"
                    },
                    crewMembers: {
                        defaultValue: []
                    },
                    boatId: {
                        type: "number"
                    }
                }
            });
            var data = [
            new Boat({ destination: "Chipotle", crewMembers: [ { name: "Todd" }, { name: "Jeff" } ], boatId: 2 })
            ];

            var dataSource = new kendo.data.DataSource({
                data: data,
                schema: {
                    model: Boat
                }
            });

            window.LunchBoat = {
                boatsViewModel: kendo.observable({
                    boats: dataSource
                }),
                addSelfToBoat: function (e) {
                    var boat = window.LunchBoat.boatsViewModel.boats.data()[0];
                    boat.crewMembers.push({ name: "Self" });
                }
            };

            var app = new kendo.mobile.Application(document.body, {});
        </script>
    </body>
</html>
