 <!DOCTYPE html>
 <html>
 <head>
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
     <title>ToKenDo</title>

    <link rel="stylesheet" href="layout.css" />
    
    <style>
        body {
            font-family: Verdana, sans-serif;
        }

        .item
        {
            line-height: 2.4em;
            display: block;
            border-bottom: 1px solid #ddd;
        }
    </style>

    <script src="../src/zepto.js"></script>
    <script src="../src/detect.js"></script>

    <script type="text/html" id="item_tmpl">
        <label class="item" for="isdone_<%=i%>">
            <input type="checkbox" id="isdone_<%=i%>" <%=(done ? " checked='checked'" : "")%> />
            <%=title%>
        </label>
    </script>    
        
    <script>
        // Simple JavaScript Templating
        // John Resig - http://ejohn.org/ - MIT Licensed
        (function(){
          var cache = {};
         
          this.tmpl = function tmpl(str, data){
            // Figure out if we're getting a template, or if we need to
            // load the template - and be sure to cache the result.
            var fn = !/\W/.test(str) ?
              cache[str] = cache[str] ||
                tmpl(document.getElementById(str).innerHTML) :
             
              // Generate a reusable function that will serve as a template
              // generator (and which will be cached).
              new Function("obj",
                "var p=[],print=function(){p.push.apply(p,arguments);};" +
               
                // Introduce the data as local variables using with(){}
                "with(obj){p.push('" +
               
                // Convert the template into pure JavaScript
                str
                  .replace(/[\r\t\n]/g, " ")
                  .split("<%").join("\t")
                  .replace(/((^|%>)[^\t]*)'/g, "$1\r")
                  .replace(/\t=(.*?)%>/g, "',$1,'")
                  .split("\t").join("');")
                  .split("%>").join("p.push('")
                  .split("\r").join("\\'")
              + "');}return p.join('');");
           
            // Provide some basic currying to the user
            return data ? fn( data ) : fn;
          };
        })();

        /// kendo.mobile

        function View(options) {
            $.extend(this, options);
            this.element = $('<div />').appendTo(document.body);
        }

        View.prototype = {
            bind: function(data) {
                this.onBind(data, this.element);
            }
        };

        function Application(options) {
            $.extend(this, options);
            this.running = false;
        }

        Application.prototype = {
            run: function() {
                if (this.running)
                    return;

                this.running = true;

                var that = this;

                window.addEventListener("DOMContentLoaded", function() {

                    that.root = $("<div />")
                        .appendTo(document.body);

                    that.show(0);
                }, false);

                        window.scrollTo(0,1);
            },
            show: function(viewIndex) {
                this.views[viewIndex].element.appendTo(this.root);
            }
        };

        // ToKenDo application code

        var taskList = new View({
            onBind: function(data, element) {
                element.html(data.map(function(x, i) {
                    return tmpl("item_tmpl", $.extend({ i: i }, x));
                }).join(''));
            }
        });

        taskList.bind([
            { title: "Change a lightbulb together with the team", done: true },
            { title: "Shop groceries", done: false },
            { title: "Go through issues on GitHub", done: false },
            { title: "Run qUnit tests", done: true },
            { title: "Get cat food", done: false },
            { title: "Clean the living room", done: false },
            { title: "Cook something nice with George", done: false },
            { title: "Perform a miracle", done: false },
            { title: "Ship a product", done: false },
            { title: "Buy a nice bottle of wine for anniversary celebration", done: false },
            { title: "Eat cake", done: false },
            { title: "Create orange portal", done: false },
            { title: "Create blue portal", done: false },
            { title: "Jump fanatically through portals", done: false },
            { title: "Make another list of tommorow's tasks", done: false }
        ]);

        (new Application({
            views: [ taskList ]
        })).run();
    </script>
 </head>
 <body></body>
 </html>

