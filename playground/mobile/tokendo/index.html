<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ToKenDo</title> 

    <!-- Weinre Proxy, configure to your machine if you have it. -->
    <!--<script src="http://bundev.telerik.com:8080/target/target-script-min.js"></script>-->
     
    <link rel="stylesheet/less" type="text/css" href="layout.less" />
    <link rel="stylesheet" href="scroll-container.css" />
    <link rel="stylesheet" href="tokendo.css" />

    <script src="../examples/less.js"></script>
    <script src="../../../src/jquery.js"></script>
    <script src="../../../src/kendo.core.js"></script>
    <script src="../../../src/kendo.fx.js"></script>
    <script src="../../../src/kendo.data.js"></script>
    <script src="../../../src/kendo.scroller.js"></script>
    <script src="../../../src/kendo.mobile.list.js"></script>
    <script src="../../../src/kendo.mobile.view.js"></script>
    <script src="../../../src/kendo.mobile.application.js"></script>

</head>
<body>
    <script type="text/html" id="item_tmpl">
        <ul class="k-list">
        <# for (var i = 0; i < data.length; i++) {
            var item = data[i]; #>
            <li class="k-item">
                <label for="isdone_<#= i #>" <#= (item.done ? " class='k-item-checked'" : "") #>>
                    <input type="checkbox" id="isdone_<#= i #>" <#= (item.done ? " checked='checked'" : "") #> />
                    <span><#= item.title #></span>
                    <a href="#" class="more-details">&nbsp;</a>
                </label>
            </li>
        <# } #>
        </ul>
    </script>
    <div class="k-slot">
        <div class="k-showcase">
            <div class="k-view">
                <div class="k-header">
                    <div class="k-toolbar">
                        <button style="float: right"><span>About</span></button>
                    </div>
                </div>

                <div class="k-content">
                    <div class="k-contentIn"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="k-tabStrip">
        <button class="k-state-active">
            <span class="k-icon"></span><span>Featured</span>
        </button>
        <button>
            <span class="k-icon"></span><span>Genius</span><span class="k-message">3</span>
        </button>
        <button>
            <span class="k-icon"></span><span>Top Charts</span>
        </button>
        <button>
            <span class="k-icon"></span><span>Categories</span>
        </button>
    </div>
    <script>
        $(document)
            .bind("appinit", function (e, args) {
//                console.log("appinit", args);
            })
            .bind("viewinit", function (e, args) {
//                console.log("viewinit", args);
            });

        $('label').live('click', function(e) {
            var element = $(this);
            element.toggleClass('k-item-checked', document.getElementById(element.attr('for')).checked);
        });

        var dataSource = new kendo.data.DataSource({
            page: 1,
            pageSize: 20,
            transport: {
                read: {
                    url: "tokendo.data.js",
                    cache: true,
                    dataType: "jsonp",
                    jsonpCallback: "loadTodoItems"
                }
            },
            reader: {
                data: function(result) {
                    return result;
                },
                total: function(result) {
                    return result;
                }
            }
        });

        dataSource.bind("change", function() {
            var data = dataSource.view();
            var template = kendo.template(document.getElementById("item_tmpl").innerHTML);

            $(".k-contentIn").html(template({ data: data }))
                .delegate('.more-details', 'click', function(e) {
                    e.preventDefault();
                    var todoItemId = $(this).index();
                    kendo.mobile.switchView("edit.html");
                });
        });

        dataSource.read();
    </script>
</body>
</html>

