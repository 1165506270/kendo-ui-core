<!DOCTYPE html>
<html>
    <head>
        <title>MVVM</title>


        <link rel="stylesheet" href="../styles/web/kendo.common.css"/>
        <link rel="stylesheet/less" type="text/css" href="../styles/web/kendo.default.less"/>

        <script src="../demos/mvc/content/shared/js/less.js"></script>

        <script src="../src/jquery.js"></script>
        <script src="../src/kendo.core.js"></script>
        <script src="../src/kendo.data.js"></script>
        <script src="../src/kendo.binder.js"></script>
        <script src="../src/kendo.popup.js"></script>
        <script src="../src/kendo.list.js"></script>
        <script src="../src/kendo.dropdownlist.js"></script>

        <style>
            table, td, th {
                border: 1px solid black;
                border-collapse: collapse;
            }
        </style>

        <script>
            var Class = kendo.Class;

            var Binding = Class.extend( {
                init: function(source, path) {
                    this.source = source;
                    this.path = path;
                },

                get: function() {
                    return this.source.get(this.path);
                },

                set: function(value) {
                }
            });

            var DomElement = Class.extend( {
                init: function(target) {
                    this.target = target;
                },

                setBinding: function(path, binding) {
                    var expression = new BindingExpression(new Property(this.target, path), binding);
                    expression.updateTarget();
                }
            });

            var BindingExpression = Class.extend( {
                init: function(property, binding) {
                    this.property = property;
                    this.binding = binding;
                },

                updateTarget: function() {
                    this.property.set(this.binding.get());
                }
            });

            var Property = Class.extend( {
                init: function(target, path) {
                    this.target = target;
                    this.path = path;
                },

                get: function() {
                    return null;
                },

                set: function(value) {
                    this.target[this.path] = value;
                }
            });

            function bind(target, source) {
                var path = target.getAttribute("data-text");

                var binding = new Binding(source, path);

                var element = new DomElement(target);

                element.setBinding("innerText", binding);
            }
        </script>
    </head>
    <body>
        <form>

            <div data-text="foo"></div>
        </form>

        <script>
            var viewModel = kendo.observable({
                foo: "foo"
            });

            bind($("div")[0], viewModel);
        </script>
    </body>
</html>

