<!DOCTYPE html>
<html>
<head>
    <title>Export to Excel via XLSX.js</title>
    <link href="http://cdn.kendostatic.com/2014.1.416/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2014.1.416/styles/kendo.default.min.css" rel="stylesheet" />
    <script src="loader.js"></script>
    <script src="../src/jszip.min.js"></script>
    <script>
        requireSync([
            "../src/jquery",
            "../src/kendo.ooxml",
            "../src/kendo.grid"
        ]);
    </script>
</head>
<body>
    <h1>JavaScript-only export to Excel</h1>
    <h2>Supported browsers</h2>
    <ul>
      <li>Google Chrome</li>
      <li>Firefox</li>
      <li>IE10+</li>
    </ul>
    <a download="Contacts.xlsx" class="k-button" id="export">Export</a>
    <div id="grid" style="height: 365px"></div>
    <script>
        $("grid").kendoGrid({
          toolbar: '',
          dataSource: {
              type: "odata",
              transport: {
                  read: "http://demos.telerik.com/kendo-ui/service/Northwind.svc/Customers"
              },
              pageSize: 10
          },
          sortable: true,
          pageable: {
              refresh: true,
              pageSizes: true,
              buttonCount: 5
          },
          columns: [{
              field: "ContactName",
              title: "Contact Name",
              width: 200
          }, {
              field: "ContactTitle",
              title: "Contact Title",
              width: 250
          }, {
              field: "CompanyName",
              title: "Company Name"
          }, {
              field: "Country",
              width: 150
          }]
      })

      $("#export").on("click", excel);

      function excel() {
        var grid = $("#grid").data("kendoGrid");

        var base64 = new kendo.ooxml.Workbook({
            sheets: [
                {
                    title: "My sheet",
                    freezePane: {
                        rowSplit: 1,
                        colSplit: 2
                    },
                    columns: [
                        { width: 300 }
                    ],
                    data: [
                        [
                            { background: "#f0f", color: "#aaf", bold: true, value: "Bold with background and foreground" },
                            { background: "#ffeeff", italic: true, underline: true, value: "Italic and underline" },
                            { fontName: "Arial", fontSize: 20, value: "Font and font Size" },
                            { value: new Date() },
                            { format: "yy-mm-dd", value: new Date() },
                            { value: 42 },
                            { value: false }
                        ],
                        [
                            { italic: true, value: new Date() },
                            { color: "#0f0", value: 3.14 },
                            { value: true }
                        ]
                    ]
                },
                {
                    title: "My second sheet",
                    data: [
                            [ { colSpan: 3, value: "colSpan = 3" }, { value: "Boo" }],
                            [ { colSpan: 2, value: "colSpan = 2" }, { value: "Boo" }],
                            [ { rowSpan: 2, value: "rowSpan = 2" }, { value: "Boo" }],
                            [ { rowSpan: 2, colSpan: 3, hAlign: "right", vAlign: "top", value: "rowSpan=2, colspan=3" }]
                    ]
                }
            ]
        }).toDataURL();

        kendo.saveAs(base64, "Export.xlsx", "http://korchev:88/filesaver");
      }

    </script>
</body>
</html>
