<!DOCTYPE html>
<html>
    <head>
        <title>CurveProcessor</title>
        <script src="../jquery-loader.js"></script>
        <script src="../qunit/qunit/qunit.js"></script>
        <script src="../qunit/addons/close-enough/qunit-close-enough.js"></script>
        <script src="../kendo-test-helpers.js"></script>
        <link href="../qunit/qunit/qunit.css" type="text/css" rel="stylesheet"/>
    </head>
    <body>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.data.js"></script>
        <script src="../../src/kendo.dataviz.core.js"></script>
        
        <script src="util.js"></script>
        <script type="text/javascript">
         (function() {
            var kendo = window.kendo,                       
                dataviz = kendo.dataviz,
                Point = dataviz.Point2D,
                CurveProcessor = dataviz.CurveProcessor,
                processor = new CurveProcessor(0,false);
                               
            module("curveprocessor / monotonic", {
            });
            
            test("ascending points are correctly detected", function() {
                var p0 = new Point(1,2),
                    p1 = new Point(1.1, 3),
                    p2 = new Point(4, 3.1),
                    monotonicByX = processor.isMonotonicByField(p0,p1,p2, "x"),
                    monotonicByY = processor.isMonotonicByField(p0,p1,p2, "y");                        
                ok(monotonicByX && monotonicByY);
            }); 

            test("descending points are correctly detected", function() {
                var p0 = new Point(4, 3),
                    p1 = new Point(1.1, 2),
                    p2 = new Point(1, 1.99),
                    monotonicByX = processor.isMonotonicByField(p0,p1,p2, "x"),
                    monotonicByY = processor.isMonotonicByField(p0,p1,p2, "y");                        
                ok(monotonicByX && monotonicByY);
            });  

            test("points with equal values are not monotonic", function() {
                var p0 = new Point(4, 3),
                    p1 = new Point(4, 2),
                    p2 = new Point(1, 2),
                    monotonicByX = processor.isMonotonicByField(p0,p1,p2, "x"),
                    monotonicByY = processor.isMonotonicByField(p0,p1,p2, "y");                        
                ok(!(monotonicByX || monotonicByY));
            });            
            
            module("curveprocessor / orientation", {
            });
             
            test("the axes are not inverted for ascending by X points", function() {
                var p0 = new Point(1,2),
                    p1 = new Point(1.1, 3),
                    p2 = new Point(4, 3),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "x" && result.yField == "y");
            }); 

            test("the axes are not inverted for descending by X points", function() {
                var p0 = new Point(4,2),
                    p1 = new Point(1.1, 3),
                    p2 = new Point(1, 3),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "x" && result.yField == "y");
            });

            test("the axes are inverted for descending by y points when the third point is below the line determined by the first two", function() {
                var p0 = new Point(4, 3),
                    p1 = new Point(6, 2),
                    p2 = new Point(4, 1),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "y" && result.yField == "x");
            });

            test("the axes are inverted for ascending by y points when the third point is above the line determined by the first two", function() {
                var p0 = new Point(4, 2),
                    p1 = new Point(6, 3),
                    p2 = new Point(4, 4),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "y" && result.yField == "x");
            });        

            test("the axes are not inverted when the third point is below the line determined by the first two", function() {
                var p0 = new Point(1, 1),
                    p1 = new Point(3, 3),
                    p2 = new Point(2.5, 2),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "x" && result.yField == "y");
            }); 

            test("the axes are not inverted when the third point is above the line determined by the first two", function() {
                var p0 = new Point(3, 3),
                    p1 = new Point(1, 1),
                    p2 = new Point(1.5, 2),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "x" && result.yField == "y");
            });            
            
            test("the axes are inverted for descending by y points when the first two points have equal x value", function() {
                var p0 = new Point(2, 5),
                    p1 = new Point(2, 4),
                    p2 = new Point(4, 3),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "y" && result.yField == "x");
            });
            

            test("the axes are inverted for ascending by y points when the first two points have equal x value", function() {
                var p0 = new Point(2, 2),
                    p1 = new Point(2, 3),
                    p2 = new Point(4, 4),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "y" && result.yField == "x");
            }); 
            
            test("the axes are not inverted when the points are on the same line", function() {
                var p0 = new Point(1, 1),
                    p1 = new Point(3, 3),
                    p2 = new Point(4, 4),
                    result = processor.getOrientation(p0,p1,p2);                
                ok(result.xField == "x" && result.yField == "y");
            });

            module("curveprocessor / isLine", {
            });   
                
            test("monotonic points on the same line are detected", function() {
                var p0 = new Point(1, 1),
                    p1 = new Point(3, 3),
                    p2 = new Point(4, 4),
                    result = processor.isLine(p0,p1,p2);                
                ok(result);
            });

            test("points on the same line are detected when the third point is before the second point", function() {
                var p0 = new Point(2, 2),
                    p1 = new Point(4, 4),
                    p2 = new Point(1, 1),
                    result = processor.isLine(p0,p1,p2);                
                ok(result);
            });    
            
            test("points on the same line are detected for a vertical line", function() {
                var p0 = new Point(1, 5),
                    p1 = new Point(1, 4),
                    p2 = new Point(1, 1),
                    result = processor.isLine(p0,p1,p2);                
                ok(result);
            });
                       
            test("points on the same line are detected for a vertical line when the third point is before the second point", function() {
                var p0 = new Point(1, 5),
                    p1 = new Point(1, 1),
                    p2 = new Point(1, 4),
                    result = processor.isLine(p0,p1,p2);                
                ok(result);
            });
            
            module("curveprocessor / tangent", {
            });

            test("tangent is correctly calculated", function() {
                var p0 = new Point(1, 5),
                    p1 = new Point(3, 4),
                    result = processor.getTangent(p0,p1, "x", "y");                
                equal(result, -1 / 2);
            });  

            test("tangent is 0 for equal by x points", function() {
                var p0 = new Point(1, 5),
                    p1 = new Point(1, 4),
                    result = processor.getTangent(p0,p1, "x", "y");                
                equal(result, 0);
            }); 

            module("curveprocessor / control points", {
            }); 
           
                       
        })();
        </script>

        <h1 id="qunit-header">CurveProcessor</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <div id="qunit-fixture">test markup, will be hidden</div>
        <ul id="log"></ul>

        <div id="container">
        </div>
    </body>             