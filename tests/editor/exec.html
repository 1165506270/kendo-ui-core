<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>kendo.ui.Editor Tests</title>

        <script src="test-scripts.js"></script>

        <style> html { font-size: 12px; } </style>
    </head>
    <body>

        <div><textarea cols="20" rows="4" id="Editor1" name="Editor1"></textarea></div>

        <script>

            $("#Editor1").kendoEditor();

            function assertCommand(type, name) {
                var command;

                withMock(editor.undoRedoStack, "push", function () { command = arguments[0]; }, function() {
                    editor.value("foo");

                    var range = editor.createRange();
                    range.selectNodeContents(editor.body);
                    editor.selectRange(range);
                    editor.exec(name);

                    ok(command instanceof type);
                });
            }

            module("Exec", {
                setup: function() {
                    editor = getEditor();
                    editor.focus();
                }
            });

            test("exec pushes command to undo stack", function() {
                editor.value("foo");
                var range = editor.createRange();
                range.selectNodeContents(editor.body.firstChild);
                editor.selectRange(range);

                var pushArgument;

                editor.undoRedoStack.push = function() { pushArgument = arguments[0] }

                editor.exec("bold");

                ok(undefined !== pushArgument);
            });

            test("exec undo performs undo", function() {
                var called = false;

                withMock(editor.undoRedoStack, "undo", function () { called = true; }, function() {
                    editor.exec("undo");

                    ok(called);
                });
            });

            test("exec redo performs redo", function() {
                var called = false;

                withMock(editor.undoRedoStack, "redo", function () { called = true; }, function() {
                    editor.exec("redo");

                    ok(called);
                });
            });

            test("exec inline command", function() {
                $.each(["bold", "italic", "underline", "strikethrough"], function() {
                    assertCommand(kendo.ui.editor.FormatCommand, this);
                });
            });

            test("exec unordered list", function() {
                assertCommand(kendo.ui.editor.ListCommand, "insertUnorderedList");
            });

            test("exec ordered list", function() {
                assertCommand(kendo.ui.editor.ListCommand, "insertOrderedList");
            });

            test("exec block command", function() {
                $.each(["justifyCenter", "justifyLeft", "justifyRight", "justifyFull"], function() {
                    assertCommand(kendo.ui.editor.FormatCommand, this);
                });
            });

            test("exec insertLineBreak creates newLineCommand", function() {
                assertCommand(kendo.ui.editor.NewLineCommand, "insertLineBreak");
            });

            test("exec insertParagraph creates paragraph command", function() {
                assertCommand(kendo.ui.editor.ParagraphCommand, "insertParagraph");
            });

            test("exec createLink creates LinkCommand", function() {
                assertCommand(kendo.ui.editor.LinkCommand, "createLink");
            });

            test("exec unlink creates UnlinkCommand", function() {
                assertCommand(kendo.ui.editor.UnlinkCommand, "unlink");
            });

            test("exec insertImage creates image command", function() {
                assertCommand(kendo.ui.editor.ImageCommand, "insertImage");
            });

            test("exec indent creates indent command", function() {
                assertCommand(kendo.ui.editor.IndentCommand, "indent");
            });

            test("exec outdent creates indent command", function() {
                assertCommand(kendo.ui.editor.OutdentCommand, "outdent");
            });

        </script>

        <h1 id="qunit-header">kendo.ui.Editor Tests</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <div id="qunit-fixture">test markup, will be hidden</div>
        <ul id="log"></ul>

    </body>
</html>
