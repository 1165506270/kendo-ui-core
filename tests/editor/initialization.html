<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>kendo.ui.Editor Tests</title>
        <script src="test-scripts.js"></script>
        <style> html { font-size: 12px; } </style>
    </head>
    <body>

        <script>
            var editor, textarea;

            module("editor initialization", {
                setup: function() {
                    textarea = $("<textarea />").appendTo(document.body);
                },
                teardown: function() {
                    $(".k-widget").remove();
                    textarea.remove();
                }
            });

            function setup(content, options) {
                editor = textarea.val(content).kendoEditor(options).data("kendoEditor");
            }

            test("editor value is get from textarea", function() {
                setup("foo");

                equal(editor.value(), "foo");
            });

            test("color tools react to palette definition", function() {
                var customColor = "#ff1ff1"
                setup("bar", {
                    tools: [
                        { name: "foreColor", palette: [customColor] }
                    ]
                });

                var colorpicker = $("[data-role=colorpicker]");

                equal(colorpicker.length, 1);
                deepEqual(colorpicker.data("kendoColorPicker").options.palette, [customColor]);
                equal(colorpicker.data("kendoColorPicker").value(), customColor);
            });

            test("define global ColorTool palette", function() {
                var customColor = "#ff1ff1"

                var defaultPalette = kendo.ui.editor.ColorTool.fn.options.palette;
                kendo.ui.editor.ColorTool.fn.options.palette = [customColor];

                setup("baz");

                var colorpickers = $("[data-role=colorpicker]");

                deepEqual(colorpickers.eq(0).data("kendoColorPicker").options.palette, [customColor]);
                equal(colorpickers.eq(0).data("kendoColorPicker").value(), customColor);
                deepEqual(colorpickers.eq(1).data("kendoColorPicker").options.palette, [customColor]);
                equal(colorpickers.eq(1).data("kendoColorPicker").value(), customColor);

                kendo.ui.editor.ColorTool.fn.options.palette = defaultPalette;
            });

            module("initialization from div[contentEditable]", {
                teardown: function() {
                    $(".k-widget, .k-editor-toolbar").remove();
                }
            });

            test("returns proper initial content", function() {
                var dom = $("<div contentEditable='true'><p>foo</p></div>").appendTo("body");
                dom.kendoEditor();

                equal(dom.data("kendoEditor").value(), "<p>foo</p>");
            });

            test("adds k-editor class to contentEditable", function() {
                var dom = $("<div contentEditable='true'><p>foo</p></div>").appendTo("body");

                dom.kendoEditor();

                ok(dom.hasClass("k-editor"));
                ok(dom.hasClass("k-editor-inline"));
                ok(dom.hasClass("k-widget"));
            });

            if (!kendo.support.browser.msie) {
                test("processes value when initializing", function() {
                    var dom = $("<div contentEditable><p></p></div>").appendTo("body");
                    dom.kendoEditor();

                    equal(dom.find("br").length, 1);
                });
            }
        </script>

        <h1 id="qunit-header">kendo.ui.Editor Tests</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <div id="qunit-fixture">test markup, will be hidden</div>
        <ul id="log"></ul>

    </body>
</html>
