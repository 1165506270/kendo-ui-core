
<!DOCTYPE htm\s*l>
<html>
    <head>
        <meta charset="utf-8" />
        <title>kendo.ui.Editor Tests</title>

        <script src="../jquery-loader.js"></script>
        <script src="test-scripts.js"></script>

        <style> html { font-size: 12px; } </style>
    </head>
    <body>
        <h1 id="qunit-header">kendo.ui.Editor Tests</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <div id="qunit-fixture">test markup, will be hidden</div>
        <ul id="log"></ul>

        <script>
            var tool;

            module("Editor / InsertTableTool", {
                setup: function() {
                    editor = $("<textarea></textarea>").appendTo("#qunit-fixture").kendoEditor().data("kendoEditor");
                    tool = editor.wrapper.find('.k-createTable').parent();
                },
                teardown: function() {
                    editor.destroy();
                    editor.wrapper.remove();
                }
            });

            test("clicking a cell inserts a table", function() {
                tool.click();

                var cell = $(".k-ct-cell:first"),
                    offset = cell.offset();

                cell.trigger({
                    type: "mouseup",
                    clientX: offset.left + cell.width()/2,
                    clientY: offset.top + cell.height()/2
                });

                var dom = $("<div>" + editor.value() + "</div>");

                equal(dom.find("table").length, 1);
                equal(dom.find("tr:not(.k-selection-row)").length, 1);
                equal(dom.find("td:not(.k-selection-cell,.k-select-all)").length, 1);

                tool.click();
            });

            test("clicking the tool while it is disabled does not toggle the popup", function() {
                tool.addClass("k-state-disabled");

                tool.click();
                equal($(".k-ct-popup:visible").length, 0);

                tool.click();
                equal($(".k-ct-popup:visible").length, 0);
            });

        </script>
    </body>
</html>
