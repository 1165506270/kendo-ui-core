<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>kendo.ui.Editor Tests</title>

<script src="../../src/jquery.js"></script>
<script src="../qunit/qunit/qunit.js"></script>
<script src="../qunit-runner.js"></script>
<script src="../../src/kendo.core.js"></script>
<script src="../../src/kendo.editor.js"></script>
<script src="util.js"></script>

<link rel="stylesheet" href="../qunit/qunit/qunit.css" />
<link rel="stylesheet" href="../../styles/web/kendo.common.css" />

<style> html { font-size: 12px; } </style>
</head>
<body>

<script>

$("#Editor1").kendoEditor({
    tools: ["bold"]
});

QUnit.testStart = function() {
    editor = getEditor();
    impl = {
        formatRange: function(range, format) {
            var command = new kendo.ui.Editor.FormatCommand({
                range:range,
                format: format,
                formatter: function() {
                    return new kendo.ui.Editor.BlockFormatter(format);
                }
            })
            command.exec();
        }
    }
}

test('removeFormat applies block format on full selection', function() {
    editor.value('<p style="text-align:center;">golgafrincham</p>');

    var pararagraph = $('p', editor.document)[0].firstChild;
    var range = editor.createRange();
    range.setStart(pararagraph, 0);
    range.setEnd(pararagraph, 13);

    impl.formatRange(range, editor.formats.justifyCenter);
            
    equal(editor.value(), '<p>golgafrincham</p>');
});

test('removeFormat applies block format on partial selection', function() {
    editor.value('<p style="text-align:center;">golgafrincham</p>');

    var pararagraph = $('p', editor.document)[0].firstChild;
    var range = editor.createRange();
    range.setStart(pararagraph, 5);
    range.setEnd(pararagraph, 10);

    impl.formatRange(range, editor.formats.justifyCenter);
            
    equal(editor.value(), '<p>golgafrincham</p>');
});

test('removeFormat applies block format on partial selection with line break', function() {
    editor.value('<p style="text-align:center;">golga<br />frincham</p>');

    var pararagraph = $('p', editor.document)[0];
    var range = editor.createRange();
    range.setStart(pararagraph.firstChild, 2);
    range.setEnd(pararagraph.lastChild, 4);

    impl.formatRange(range, editor.formats.justifyCenter);
            
    equal(editor.value(), '<p>golga<br />frincham</p>');
});

</script>

<h1 id="qunit-header">kendo.ui.Editor Tests</h1>
<h2 id="qunit-banner"></h2>
<div id="qunit-testrunner-toolbar"></div>
<h2 id="qunit-userAgent"></h2>
<ol id="qunit-tests"></ol>
<div id="qunit-fixture">test markup, will be hidden</div>
<ul id="log"></ul>

<div><textarea cols="20" rows="4" id="Editor1" name="Editor1"></textarea></div>

</body>
</html>