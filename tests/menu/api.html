<!DOCTYPE html>
<html>
    <head>
        <title>kendo.ui.menu Tests</title>
        <script src="../../src/jquery.js"></script>
        <script src="../qunit.js"></script>
        <script src="../qunit-runner.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.fx.js"></script>
        <script src="../../src/kendo.popup.js"></script>
        <script src="../../src/kendo.menu.js"></script>
        <script type="text/javascript" src="../jquery.mockjax.js"></script>
        <link rel="stylesheet" href="../qunit.css" />
        <link type="text/css" href="../../styles/kendo.common.css" rel="stylesheet"/>
        <link type="text/css" href="../../styles/kendo.vista.css" rel="stylesheet"/>
        <script type="text/javascript">

            var isRaised, isOpenRaised, isCloseRaised, isSelectRaised;

             function getRootItem(index) {
                 return $('#Menu1').find('> .t-item').eq(index)
             }

             function getMenu() {
                 return $("#Menu1").data("kendoMenu");
             }

             //handlers
             function Open() {
                 isOpenRaised = true;
             }

             function Close() {
                 isCloseRaised = true;
             }

             function Select() {
                 isSelectRaised = true;
             }


             var onLoadMenu;

             function Load() {
                 isRaised = true;
                 onLoadMenu = getMenu();
             }
        </script>
    </head>
    <body onload="Load()">

    <ul id="Menu1" class="t-widget t-reset t-header t-menu" style="visibility: hidden; top: -10000px">
        <li class="t-item t-state-default" style=""><span class="t-link"><img
                src="../../playground/Icons/Suites/mvc.png" class="t-image" alt="image">ASP.NET MVC<span
                class="t-icon t-arrow-down"></span></span>

            <ul class="t-group">
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Mvc/Grid.png" class="t-image" alt="image">Grid</span>
                </li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Mvc/Menu.png" class="t-image" alt="image">Menu<span
                class="t-icon t-arrow-next"></span></span>
                    <ul class="t-group">
                        <li class="t-item t-state-default"><span class="t-link"><img
                                src="../../playground/Icons/Mvc/Grid.png" class="t-image" alt="image">Grid</span>
                        </li>
                        <li class="t-item t-state-default"><span class="t-link"><img
                                src="../../playground/Icons/Mvc/Menu.png" class="t-image" alt="image">Menu</span>
                        </li>
                        <li class="t-item t-state-default"><span class="t-link"><img
                                src="../../playground/Icons/Mvc/PanelBar.png" class="t-image"
                                alt="image">PanelBar</span></li>
                        <li class="t-item t-state-default"><span class="t-link"><img
                                src="../../playground/Icons/Mvc/TabStrip.png" class="t-image"
                                alt="image">TabStrip</span></li>
                    </ul>
                </li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Mvc/PanelBar.png" class="t-image"
                        alt="image">PanelBar</span></li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Mvc/TabStrip.png" class="t-image"
                        alt="image">TabStrip</span></li>
            </ul>
        </li><li class="t-item t-state-default"><span class="t-link"><img src="../../playground/Icons/Suites/sl.png"
                                                                     class="t-image" alt="image">Silverlight<span
                class="t-icon t-arrow-down"></span></span>
            <ul class="t-group">
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Sl/GridView.gif" class="t-image" alt="image">GridView</span>
                </li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Sl/Scheduler.gif" class="t-image"
                        alt="image">Scheduler</span></li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Sl/Docking.gif" class="t-image" alt="image">Docking</span>
                </li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Sl/Chart.gif" class="t-image" alt="image">Chart</span></li>
                <li class="t-item t-state-default"><a href="http://www.telerik.com/products/silverlight.aspx"
                                                      class="t-link">... and 28 more!</a></li>
            </ul>
        </li><li class="t-item t-state-default"><span class="t-link"><img src="../../playground/Icons/Suites/ajax.png"
                                                                     class="t-image" alt="image">ASP.NET AJAX<span
                class="t-icon t-arrow-down"></span></span>
            <ul class="t-group">
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Ajax/Grid.png" class="t-image" alt="image">Grid</span></li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Ajax/Editor.png" class="t-image" alt="image">Editor</span>
                </li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Ajax/Scheduler.png" class="t-image"
                        alt="image">Scheduler</span></li>
                <li class="t-item t-state-default"><a href="http://www.telerik.com/products/aspnet-ajax.aspx"
                                                      class="t-link">... and 28 more!</a></li>
            </ul>
        </li><li class="t-item t-state-default"><a href="#Menu-4" class="t-link"><img
                src="../../playground/Icons/Suites/orm.png" class="t-image" alt="image">OpenAccess ORM<span
                class="t-icon t-arrow-down"></span></a>
            <ul class="t-group">
                <li class="t-item">
                    <div id="Menu-4" class="t-content">
                        <img alt="Telerik OpenAccess" src="../../playground/Icons/orm-comparison.png">
                        <a href="http://www.telerik.com/purchase/individual/orm.aspx" id="buy">
                            Telerik OpenAccess ORM
                        </a>
                        <a href="http://www.telerik.com/community/license-agreement.aspx?pId=639" id="express">
                            Telerik OpenAccess ORM Express
                        </a>
                    </div>
                </li>
            </ul>
        </li><li class="t-item t-state-default"><span class="t-link"><img src="../../playground/Icons/Suites/rep.png"
                class="t-image" alt="image">Reporting</span></li><li class="t-item t-state-default"><span class="t-link"><img
                src="../../playground/Icons/Suites/sitefinity.png" class="t-image" alt="image">Sitefinity ASP.NET CMS</span>
        </li><li style="border-right: 0;" class="t-item t-state-default"><span class="t-link">Other products<span
                class="t-icon t-arrow-down"></span></span>
            <ul class="t-group">
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Suites/test.png" class="t-image" alt="image">Web Testing Tools</span>
                </li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Suites/win.png" class="t-image" alt="image">WinForms UI Controls</span>
                </li>
                <li class="t-item t-state-default"><span class="t-link"><img
                        src="../../playground/Icons/Suites/wpf.png" class="t-image"
                        alt="image">WPF UI Controls</span></li>
            </ul>
        </li>
    </ul>

<script type="text/javascript">

        $("#Menu1").kendoMenu({ animation: false, select: Select, open: Open, close: Close });

        var menu;

        module("Menu / ClientSideAPI", {
            setup: function () {
                menu = getMenu();
            }
        });

        test('click method should call preventDefault method', function() {
            var item = getRootItem(3);
            var isCalled = false;
            menu.options.openOnClick = true;

            var e = { currentTarget: item, preventDefault: function () { isCalled = true; }, stopPropagation: function () { } };

            menu._click(e, item);

            ok(isCalled);
        });

        test('click method should call stopPropagation method always', function() {
            var item = getRootItem(3);
            var isCalled = false;

            var e = { stopPropagation: function () { isCalled = true; }, preventDefault: function () { } };

            menu._click(e, item);

            ok(isCalled);
        });

        test('hovering root item opens it and raises open event', function() {
            var item = getRootItem(1);

            menu._mouseenter({}, $("li:first", item)[0]);

            ok(isOpenRaised);
        });

        test('leaving root item closes it and raises close event', function() {
            var item = getRootItem(1);

            menu._mouseleave({}, $("li:first", item)[0]);

            ok(isCloseRaised);
        });

        test('clicking should raise select event', function() {
            var item = getRootItem(6);

            isSelectRaised = false;

            item.find('> .t-link').trigger('click');

            ok(isSelectRaised);
        });

        test('open should not open item is disabled', function() {
            var item = getRootItem(3);

            menu.open(item);

            equal(item.find('> .t-group').css("display"), "none");
        });

        test('disable method should disable enabled item', function() {
            var item = getRootItem(2);

            menu.disable(item);

            ok(item.hasClass('t-state-disabled'));
        });

        test('enable method should enable disabled item', function() {
            var item = getRootItem(3);

            menu.enable(item);

            ok(item.hasClass('t-state-default'));
        });

        test('client object is available in on load', function() {
            ok(null !== onLoadMenu);
            ok(undefined !== onLoadMenu);
        });


</script>

    <h1 id="qunit-header">kendo.ui.Menu Tests</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">test markup, will be hidden</div>
    <ul id="log"></ul>
</body>
</html>
