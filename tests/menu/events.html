<!DOCTYPE html>
<html>
    <head>
        <title>kendo.ui.menu Tests</title>
        <script src="../../src/jquery.js"></script>
        <script src="../qunit/qunit/qunit.js"></script>
        <script src="../qunit-runner.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.fx.js"></script>
        <script src="../../src/kendo.popup.js"></script>
        <script src="../../src/kendo.menu.js"></script>
        <script type="text/javascript" src="../jquery.mockjax.js"></script>
        <link rel="stylesheet" href="../qunit/qunit/qunit.css" />
        <link type="text/css" href="../../styles/web/kendo.common.less" rel="stylesheet/less"/>
        <link type="text/css" href="../../styles/web/kendo.blueopal.less" rel="stylesheet/less"/>
        <script type="text/javascript" src="../../demos/mvc/content/shared/js/less.js"></script>
    </head>
    <body>

    <ul id="Menu2" style="position: absolute; visibility: hidden;">
        <li><img src="../../playground/Icons/Suites/mvc.png">ASP.NET MVC
            <ul>
                <li><img
                        src="../../playground/Icons/Mvc/Grid.png">Grid
                </li>
                <li><img
                        src="../../playground/Icons/Mvc/Menu.png">Menu
                    <ul>
                        <li><img
                                src="../../playground/Icons/Mvc/Grid.png">Grid
                        </li>
                        <li><img
                                src="../../playground/Icons/Mvc/Menu.png">Menu
                        </li>
                        <li><img
                                src="../../playground/Icons/Mvc/PanelBar.png" class="k-image"
                                alt="image">PanelBar</li>
                        <li><img
                                src="../../playground/Icons/Mvc/TabStrip.png" class="k-image"
                                alt="image">TabStrip</li>
                    </ul>
                </li>
                <li><img
                        src="../../playground/Icons/Mvc/PanelBar.png" class="k-image"
                        alt="image">PanelBar</li>
                <li><img
                        src="../../playground/Icons/Mvc/TabStrip.png" class="k-image"
                        alt="image">TabStrip</li>
            </ul>
        </li><li><img src="../../playground/Icons/Suites/sl.png">Silverlight
            <ul>
                <li><img
                        src="../../playground/Icons/Sl/GridView.gif">GridView
                </li>
                <li><img
                        src="../../playground/Icons/Sl/Scheduler.gif" class="k-image"
                        alt="image">Scheduler
                </li>
                <li><img
                        src="../../playground/Icons/Sl/Docking.gif">Docking
                </li>
                <li class="k-item k-state-disabled"><img
                        src="../../playground/Icons/Sl/Chart.gif">Chart
                </li>
                <li><a href="http://www.telerik.com/products/silverlight.aspx">... and 28 more!</a></li>
            </ul>
        </li><li><img src="../../playground/Icons/Suites/ajax.png">ASP.NET AJAX
            <ul>
                <li><img
                        src="../../playground/Icons/Ajax/Grid.png">Grid</li>
                <li><img
                        src="../../playground/Icons/Ajax/Editor.png">Editor
                </li>
                <li><img
                        src="../../playground/Icons/Ajax/Scheduler.png" class="k-image"
                        alt="image">Scheduler
                </li>
                <li><a href="http://www.telerik.com/products/aspnet-ajax.aspx">... and 28 more!</a></li>
            </ul>
        </li><li><a href="#Menu-4"><img src="../../playground/Icons/Suites/orm.png">OpenAccess ORM</a>
            <ul>
                <li>
                    <div id="Menu-4">
                        <img alt="Telerik OpenAccess" src="../../playground/Icons/orm-comparison.png">
                        <a href="http://www.telerik.com/purchase/individual/orm.aspx" id="buy">
                            Telerik OpenAccess ORM
                        </a>
                        <a href="http://www.telerik.com/community/license-agreement.aspx?pId=639" id="express">
                            Telerik OpenAccess ORM Express
                        </a>
                    </div>
                </li>
            </ul>
        </li>
            <li><img src="../../playground/Icons/Suites/rep.png">Reporting
            </li>
            <li>
                <img src="../../playground/Icons/Suites/sitefinity.png">Sitefinity ASP.NET CMS
            </li>
            <li>Other products
            <ul>
                <li><img
                        src="../../playground/Icons/Suites/test.png">Web Testing Tools
                </li>
                <li><img
                        src="../../playground/Icons/Suites/win.png">WinForms UI Controls
                </li>
                <li><img
                        src="../../playground/Icons/Suites/wpf.png" class="k-image"
                        alt="image">WPF UI Controls
                </li>
            </ul>
        </li>
    </ul>

<script type="text/javascript">

        QUnit.config.reorder = false;

        function onSelect() {
            isRaised = true;
        }

        function getRootItem(index) {
			return $('> .k-item', menu.element).eq(index);
        }

        $("#Menu2").kendoMenu({ animation: false, select: onSelect });

        var menu, isRaised,
            CLICK = "click";

        module("Menu / Client Events", {
            setup: function () {
                menu = $("#Menu2").data('kendoMenu');
            }
        });

        test("element select is triggered when menu element is clicked", function() {
            var item = getRootItem(0),
                triggerCount = 0;

            menu.bind("select", function() {
                triggerCount++;
            });

            item.trigger(CLICK);

            equal(triggerCount, 1);
        });

        test('clicking disabled item should not raise onSelect event on parent item', function() {
            var item = getRootItem(1);

            isRaised = false;

            item.find('.k-item > .k-link').eq(3).trigger('click');

            ok(!isRaised);
        });

        asyncTest("open event can be canceled", function() {
            menu.bind("open", function (e) { e.preventDefault() });
            menu.open(menu.element.children("li:first"));

            setTimeout(function () {
                equal(menu.element.find(">li:first ul").is(":visible"), false);
                start();
            }, 10);
        });

        asyncTest("activate event is fired after open", function() {
            menu.unbind("open");
            var activated = false;

            menu.bind("activate", function() {
                activated = true;
            });

            menu.open(menu.element.children("li:eq(1)"));

            setTimeout(function () {
                equal(activated, true);
                start();
            }, 100);
        });

        asyncTest("close event can be canceled", function() {
            menu.unbind("activate");
            menu.bind("close", function (e) { e.preventDefault() });

            menu.open(menu.element.children("li:eq(2)"));
            setTimeout(function () {
                menu.close(menu.element.children("li:eq(2)"));

                equal(menu.element.find(">li:eq(2) ul").is(":visible"), true);
                menu.unbind("close");
                start();
            }, 100);
        });

    </script>

    <h1 id="qunit-header">kendo.ui.Menu Tests</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">test markup, will be hidden</div>
    <ul id="log"></ul>
</body>
</html>
