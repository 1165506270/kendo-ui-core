<!DOCTYPE html>
<html>
    <head>
        <title>Recurrence dates</title>
        <script src="../jquery-loader.js"></script>
        <script type="text/javascript" src="../qunit/qunit/qunit.js"></script>
        <script src="../kendo-test-helpers.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.scheduler.js"></script>
        <link rel="stylesheet" href="../qunit/qunit/qunit.css" type="text/css" />
    </head>
    <body>
        <h1 id="qunit-header">Scheduler initialization</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <script>
            var recurrence = kendo.recurrence,
                occurrences = recurrence.expand;

            module("Recurring helper methods");

            test("expandEvent method expand original method with rrule object", function() {
                var schedulerEvent = {
                    title: "Title",
                    start: new Date(),
                    rule: "FREQ=DAILY"
                }

                recurrence.expandEvent(schedulerEvent);

                ok(schedulerEvent.ruleInstance);
            });

            test("Numbers of weeks in 01/05/2013", function() {
                equal(recurrence.numberOfWeeks(new Date(2013, 4, 1), 0), 5);
            });

            test("Numbers of weeks in 22/06/2013", function() {
                equal(recurrence.numberOfWeeks(new Date(2013, 5, 22), 0), 6);
            });

            test("weekNumber method returns number of the week (first week)", function() {
                var date = new Date(2013, 5, 1);
                equal(recurrence.weekNumber(date, 0), 1);
            });

            test("weekNumber method returns number of the week (second week)", function() {
                var date = new Date(2013, 5, 2);
                equal(recurrence.weekNumber(date, 0), 2);
            });

            test("weekNumber method returns number of the week (third week)", function() {
                var date = new Date(2013, 5, 16);
                equal(recurrence.weekNumber(date, 0), 4);
            });

            test("weekNumber method honours weekStart", function() {
                var date = new Date(2013, 5, 16);
                equal(recurrence.weekNumber(date, 1), 3);
            });

            test("weekNumber method honours weekStart ", function() {
                var date = new Date(2013, 3, 18);
                equal(recurrence.weekNumber(date, 5), 4);
            });

            test("DAILY frequency next method gets next day (interval:1)", function() {
                var next = recurrence.frequency.daily.next(new Date(2000, 10, 10, 18, 18, 18), new Date(2000, 10, 12, 18, 18, 18), { interval:1 });
                equal(+next, +new Date(2000, 10, 11, 18, 18, 18))
            });

            test("DAILY frequency next method gets the day after tomorrow (interval:2)", function() {
                var next = recurrence.frequency.daily.next(new Date(2000, 10, 10, 18, 18, 18), new Date(2000, 10, 12, 18, 18, 18), { interval:2 });
                equal(+next, +new Date(2000, 10, 12, 18, 18, 18));
            });

            module("DAILY Occurrences");
            test("DAILY occurrences method returns one occurrence (FREQ: DAILY)", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 11, 17) } );

                equal(events.length, 2);
                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 10, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2000, 10, 11, 16, 30));
                equal(events[1].end.getTime(), +new Date(2000, 10, 11, 17, 0));
            });
            test("DAILY occurrences method returns multiple occurrences (FREQ: DAILY)", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 16, 17) } );

                equal(events.length, 7);
                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 10, 17, 0));

                equal(events[6].recurrenceID, schedulerEvent.uid);
                equal(events[6].start.getTime(), +new Date(2000, 10, 16, 16, 30));
                equal(events[6].end.getTime(), +new Date(2000, 10, 16, 17, 0));
            });

            test("DAILY occurrences method honours interval rule (FREQ: DAILY)", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;INTERVAL=2"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 16, 17) } );

                equal(events.length, 4);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 10, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2000, 10, 12, 16, 30));
                equal(events[1].end.getTime(), +new Date(2000, 10, 12, 17, 0));

                equal(events[3].recurrenceID, schedulerEvent.uid);
                equal(events[3].start.getTime(), +new Date(2000, 10, 16, 16, 30));
                equal(events[3].end.getTime(), +new Date(2000, 10, 16, 17, 0));
            });

            test("DAILY occurrences method honours COUNT", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;COUNT=2"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 16) } );

                equal(events.length, 2);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 10, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2000, 10, 11, 16, 30));
                equal(events[1].end.getTime(), +new Date(2000, 10, 11, 17, 0));
            });

            test("DAILY occurrences method honours UNTIL", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;UNTIL=20001111T090000"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 16) } );

                equal(events.length, 1);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 10, 17, 0));
            });

            test("DAILY occurrences method returns empty array if not valid rule", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "UNTIL=20001111T090000"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 16) } );

                equal(events.length, 0);
            });

            test("DAILY occurrences method returns empty array if range is before the event", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;UNTIL=20001111T090000"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 9, 12), end: new Date(2000, 9, 16) } );

                equal(events.length, 0);
            });

            test("DAILY occurrences method limits BYMONTH", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;BYMONTH=11"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 30), end: new Date(2000, 11, 1, 17) } );

                equal(events.length, 1);
                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 30, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 30, 17, 0));
            });

            test("DAILY occurrences method limits BYMONTHDAY", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;BYMONTHDAY=10,13,15"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 16) } );

                equal(events.length, 3);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 10, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2000, 10, 13, 16, 30));
                equal(events[1].end.getTime(), +new Date(2000, 10, 13, 17, 0));

                equal(events[2].recurrenceID, schedulerEvent.uid);
                equal(events[2].start.getTime(), +new Date(2000, 10, 15, 16, 30));
                equal(events[2].end.getTime(), +new Date(2000, 10, 15, 17, 0));
            });

            test("DAILY occurrences method limits BYMONTHDAY (-3, 10)", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 4, 10, 16, 30),
                    end: new Date(2013, 4, 10, 17, 0),
                    rule: "FREQ=DAILY;BYMONTHDAY=-3,10"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 4, 1), end: new Date(2013, 4, 30) } );

                equal(events.length, 2);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2013, 4, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2013, 4, 10, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2013, 4, 27, 16, 30));
                equal(events[1].end.getTime(), +new Date(2013, 4, 27, 17, 0));
            });

            test("DAILY occurrences method limits BYDAY", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;BYDAY=SU, MO"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 13, 17) } );

                equal(events.length, 2);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 12, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 12, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2000, 10, 13, 16, 30));
                equal(events[1].end.getTime(), +new Date(2000, 10, 13, 17, 0));
            });

            test("DAILY occurrences method limits BYDAY (2FR)", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=DAILY;BYDAY=3FR"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 13) } );

                equal(events.length, 0);
            });

            test("DAILY occurrences method limits BYDAY (-3FR)", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 4, 10, 16, 30),
                    end: new Date(2013, 4, 10, 17, 0),
                    rule: "FREQ=DAILY;BYDAY=-3FR"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 4, 10), end: new Date(2013, 4, 24) } );

                equal(events.length, 1);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2013, 4, 17, 16, 30));
                equal(events[0].end.getTime(), +new Date(2013, 4, 17, 17, 0));
            });

            test("DAILY occurrences method returns empty array if no such day", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 4, 10, 16, 30),
                    end: new Date(2013, 4, 10, 17, 0),
                    rule: "FREQ=DAILY;BYDAY=5FR"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 4, 10), end: new Date(2013, 4, 24) } );

                equal(events.length, 0);
            });

            test("DAILY occurrences method honours INTERVAL=2", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 4, 10, 16, 30),
                    end: new Date(2013, 4, 10, 17, 0),
                    rule: "FREQ=DAILY;INTERVAL=2"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 4, 10), end: new Date(2013, 4, 17) } );
                equal(events.length, 4);
            });

            test("DAILY occurrences method honours BYDAY and INTERVAL", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 4, 17, 16, 30),
                    end: new Date(2013, 4, 17, 17, 0),
                    rule: "FREQ=DAILY;BYDAY=TU,TH;INTERVAL=2;"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 4, 17), end: new Date(2013, 5, 8) } );
                equal(events.length, 4);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2013, 4, 21, 16, 30));
                equal(events[0].end.getTime(), +new Date(2013, 4, 21, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2013, 4, 23, 16, 30));
                equal(events[1].end.getTime(), +new Date(2013, 4, 23, 17, 0));

                equal(events[2].recurrenceID, schedulerEvent.uid);
                equal(events[2].start.getTime(), +new Date(2013, 5, 4, 16, 30));
                equal(events[2].end.getTime(), +new Date(2013, 5, 4, 17, 0));

                equal(events[3].recurrenceID, schedulerEvent.uid);
                equal(events[3].start.getTime(), +new Date(2013, 5, 6, 16, 30));
                equal(events[3].end.getTime(), +new Date(2013, 5, 6, 17, 0));
            });

            module("WEEKLY Occurrences");
            test("WEEKLY occurrences method returns one event for each new week", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 11, 10) } );

                equal(events.length, 5);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 10, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 10, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2000, 10, 17, 16, 30));
                equal(events[1].end.getTime(), +new Date(2000, 10, 17, 17, 0));

                equal(events[2].recurrenceID, schedulerEvent.uid);
                equal(events[2].start.getTime(), +new Date(2000, 10, 24, 16, 30));
                equal(events[2].end.getTime(), +new Date(2000, 10, 24, 17, 0));

                equal(events[3].recurrenceID, schedulerEvent.uid);
                equal(events[3].start.getTime(), +new Date(2000, 11, 1, 16, 30));
                equal(events[3].end.getTime(), +new Date(2000, 11, 1, 17, 0));

                equal(events[4].recurrenceID, schedulerEvent.uid);
                equal(events[4].start.getTime(), +new Date(2000, 11, 8, 16, 30));
                equal(events[4].end.getTime(), +new Date(2000, 11, 8, 17, 0));
            });

            test("WEEKLY occurrences method honours BYDAY", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2000, 10, 10, 16, 30),
                    end: new Date(2000, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=SU,MO"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2000, 10, 10), end: new Date(2000, 10, 25) } );

                equal(events.length, 4);
                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2000, 10, 12, 16, 30));
                equal(events[0].end.getTime(), +new Date(2000, 10, 12, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2000, 10, 13, 16, 30));
                equal(events[1].end.getTime(), +new Date(2000, 10, 13, 17, 0));

                equal(events[2].recurrenceID, schedulerEvent.uid);
                equal(events[2].start.getTime(), +new Date(2000, 10, 19, 16, 30));
                equal(events[2].end.getTime(), +new Date(2000, 10, 19, 17, 0));

                equal(events[3].recurrenceID, schedulerEvent.uid);
                equal(events[3].start.getTime(), +new Date(2000, 10, 20, 16, 30));
                equal(events[3].end.getTime(), +new Date(2000, 10, 20, 17, 0));
            });

            test("WEEKLY occurrences method honours INTERVAL", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 10, 16, 30),
                    end: new Date(2013, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR;INTERVAL=2"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 10), end: new Date(2013, 10, 27) } );

                equal(events.length, 3);
                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2013, 10, 12, 16, 30));
                equal(events[0].end.getTime(), +new Date(2013, 10, 12, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2013, 10, 15, 16, 30));
                equal(events[1].end.getTime(), +new Date(2013, 10, 15, 17, 0));

                equal(events[2].recurrenceID, schedulerEvent.uid);
                equal(events[2].start.getTime(), +new Date(2013, 10, 26, 16, 30));
                equal(events[2].end.getTime(), +new Date(2013, 10, 26, 17, 0));
            });

            test("WEEKLY occurrences method honours INTERVAL=3", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 10, 16, 30),
                    end: new Date(2013, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR;INTERVAL=3"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 10), end: new Date(2013, 10, 27) } );
                equal(events.length, 2);
            });

            test("WEEKLY occurrences method honours COUNT=1", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 10, 16, 30),
                    end: new Date(2013, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR;INTERVAL=2;COUNT=1"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 10), end: new Date(2013, 10, 27) } );

                equal(events.length, 1);
                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2013, 10, 12, 16, 30));
                equal(events[0].end.getTime(), +new Date(2013, 10, 12, 17, 0));
            });

            test("WEEKLY occurrences method honours COUNT=5", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 10, 16, 30),
                    end: new Date(2013, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR;INTERVAL=2;COUNT=5"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 10), end: new Date(2014, 10, 27) } );

                equal(events.length, 5);
            });

            test("WEEKLY occurrences method honours UNTIL", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 10, 16, 30),
                    end: new Date(2013, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR;INTERVAL=2;UNTIL=20131126T000000"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 10), end: new Date(2013, 10, 27) } );

                equal(events.length, 2);
            });

            test("WEEKLY occurrences method returns empty array if no events", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 10, 16, 30),
                    end: new Date(2013, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR;INTERVAL=2"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2010, 10, 10), end: new Date(2010, 10, 27) } );

                equal(events.length, 0);
            });

            test("WEEKLY occurrences method starts from second day of BYDAY", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 25, 16, 30),
                    end: new Date(2013, 10, 25, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 27), end: new Date(2013, 10, 30) } );

                equal(events.length, 1);
                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2013, 10, 29, 16, 30));
                equal(events[0].end.getTime(), +new Date(2013, 10, 29, 17, 0));
            });

            test("WEEKLY occurrences method limits by BYMONTH=12 and INTERVAL=2", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 25, 16, 30),
                    end: new Date(2013, 10, 25, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=TU,FR;BYMONTH=12;INTERVAL=2"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 27), end: new Date(2014, 0, 1) } );

                equal(events.length, 5);
            });

            test("WEEKLY occurrences method limits by BYMONTH=11,12", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 25, 16, 30),
                    end: new Date(2013, 10, 25, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=FR;BYMONTH=11, 12"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 27), end: new Date(2014, 0, 1) } );

                equal(events.length, 5);
            });

            test("WEEKLY occurrences method honours BYDAY=5FR,-3TU", function() {
                var schedulerEvent = {
                    uid: "id",
                    title: "Title",
                    start: new Date(2013, 10, 10, 16, 30),
                    end: new Date(2013, 10, 10, 17, 0),
                    rule: "FREQ=WEEKLY;BYDAY=5FR,-3TU"
                }

                var events = occurrences(schedulerEvent, { start: new Date(2013, 10, 10), end: new Date(2013, 11, 1) } );

                equal(events.length, 2);

                equal(events[0].recurrenceID, schedulerEvent.uid);
                equal(events[0].start.getTime(), +new Date(2013, 10, 12, 16, 30));
                equal(events[0].end.getTime(), +new Date(2013, 10, 12, 17, 0));

                equal(events[1].recurrenceID, schedulerEvent.uid);
                equal(events[1].start.getTime(), +new Date(2013, 10, 29, 16, 30));
                equal(events[1].end.getTime(), +new Date(2013, 10, 29, 17, 0));
            });

        </script>
    </body>
</html>
