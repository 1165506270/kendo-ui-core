<!DOCTYPE html>
<html>
    <head>
        <title>Splitter client API</title>
        <script src="../../src/jquery.js"></script>
        <script src="../qunit.js"></script>
        <script src="../qunit-runner.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.draganddrop.js"></script>
        <script src="../../src/kendo.resizable.js"></script>
        <script src="../../src/kendo.splitter.js"></script>
        <script src="helper.js"></script>
        <link rel="stylesheet" href="../qunit.css" />
    </head>
    <body>
        <h1 id="qunit-header">Splitter client API</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <script>

            module("Splitter / ClientSideApi", {
                teardown: function() {
                    $('.t-splitter').remove();
                }
            });

            test("toggle(false) toggles pane state", function() {
                var splitter = $(getSplitterHtml())
                    .appendTo(document.body)
                    .kendoSplitter({
                        panes: [ { collapsible: true }, {} ]
                    }),
                    pane = splitter.find(".t-pane:first");

                splitter.data("kendoSplitter").toggle(pane, false);

                ok(pane.data("pane").collapsed);

                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ {}, { collapsible: true } ]
                });

                pane = splitter.find(".t-pane:last")

                splitter.data("kendoSplitter").toggle(pane, false);

                ok(pane.data("pane").collapsed);
            });

            test("toggle(false) triggers resize", function() {
                var triggered = false,
                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true }, {} ],
                    resize: function() {
                        triggered = true;
                    }
                });

                splitter.data("kendoSplitter").toggle(".t-pane:last", false);

                ok(triggered);
            });

            test("toggle(false) converts associated arrow to expand arrow", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true }, {} ]
                }),
                previousArrow = splitter.find(".t-collapse-prev");

                splitter.data("kendoSplitter").toggle(".t-pane:first", false);

                ok(previousArrow.is(".t-expand-prev"));
                ok(previousArrow.is(":not(.t-collapse-prev)"));
            });

            test("toggle(false) disables splitbar resize", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true }, {} ]
                });

                splitter.data("kendoSplitter").toggle(".t-pane:first", false);

                ok(!splitter.find(".t-splitbar").hasClass("t-splitbar-draggable-horizontal"));
            });

            test("toggle(true) removes splibar hover style", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true, collapsed: true }, {} ]
                });

                splitter.find(".t-splitbar").addClass("t-splitbar-horizontal-hover");

                splitter.data("kendoSplitter").toggle(".t-pane:first", false);

                ok(!splitter.find(".t-splitbar").hasClass("t-splitbar-horizontal-hover"));
            });

            test("toggle(true) toggles pane state", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true, collapsed: true }, {} ]
                }),
                pane = splitter.find(".t-pane:first");

                splitter.data("kendoSplitter").toggle(pane, true);

                ok(!pane.data("pane").collapsed);

                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ {}, { collapsible: true, collapsed: true } ]
                });

                pane = splitter.find(".t-pane:last")

                splitter.data("kendoSplitter").toggle(pane, true);

                ok(!pane.data("pane").collapsed);
            });

            test("toggle(true) triggers resize", function() {
                var triggered = false,
                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true, collapsed: true }, {} ],
                    resize: function() {
                        triggered = true;
                    }
                });

                splitter.data("kendoSplitter").toggle(".t-pane:first", true);

                ok(triggered);
            });

            test("toggle(true) converts associated arrow to collapse arrow", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true, collapsed: true }, {} ]
                }),
                previousArrow = splitter.find(".t-expand-prev");

                splitter.data("kendoSplitter").toggle(".t-pane:first", true);

                ok(previousArrow.is(".t-collapse-prev"));
                ok(previousArrow.is(":not(.t-expand-prev)"));
            });

            test("toggle(true) enables splitbar resize", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true, collapsed: true }, {} ]
                });

                splitter.data("kendoSplitter").toggle(".t-pane:first", true);

                ok(splitter.find(".t-splitbar").hasClass("t-splitbar-draggable-horizontal"));
            });

            test("toggle(true) does not add splibar hover style", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true, collapsed: true }, {} ]
                });

                splitter.data("kendoSplitter").toggle(".t-pane:first", true);

                ok(!splitter.find(".t-splitbar").hasClass("t-splitbar-horizontal-hover"));
            });

            test("toggle() without arguments toggles pane collapsed state", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true, collapsed: true }, {} ]
                });

                splitter.data("kendoSplitter").toggle(".t-pane:first");
                ok(!splitter.find(".t-pane:first").data("pane").collapsed);

                splitter.data("kendoSplitter").toggle(".t-pane:first");
                ok(splitter.find(".t-pane:first").data("pane").collapsed);

                splitter.remove();
                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true }, {} ]
                });

                splitter.data("kendoSplitter").toggle(".t-pane:first");
                ok(splitter.find(".t-pane:first").data("pane").collapsed);

                splitter.data("kendoSplitter").toggle(".t-pane:first");
                ok(!splitter.find(".t-pane:first").data("pane").collapsed);
            });

            test("collapse() calls toggle(false)", function() {
                var args,
                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true }, {} ]
                }).data("kendoSplitter");

                splitter.toggle = function() {
                    args = arguments;
                };

                splitter.collapse(".t-pane:last");

                ok(args);
                equal(args.length, 2);
                equal(args[0], ".t-pane:last");
                equal(args[1], false);
            });

            test("expand() calls toggle(true)", function() {
                var args,
                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { collapsible: true }, {} ]
                }).data("kendoSplitter");

                splitter.toggle = function() {
                    args = arguments;
                };

                splitter.expand(".t-pane:last");

                ok(args);
                equal(args.length, 2);
                equal(args[0], ".t-pane:last");
                equal(args[1], true);
            });

            test("size() gets/sets pane size", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { size: "110px" }, {} ]
                }).data("kendoSplitter"),
                firstPane = $(".t-pane:first", splitter.element);

                equals(splitter.size(firstPane), "110px");

                splitter.size(firstPane, "120px");

                equals(splitter.size(firstPane), "120px");
            });

            test("min() gets/sets pane min", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { min: "110px", size: "200px" }, {} ]
                }).data("kendoSplitter"),
                firstPane = $(".t-pane:first", splitter.element);

                equals(splitter.min(firstPane), "110px");

                splitter.min(firstPane, "120px");

                equals(splitter.min(firstPane), "120px");
            });

            test("max() gets/sets pane max", function() {
                var splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { max: "200px", size: "110px" }, {} ]
                }).data("kendoSplitter"),
                firstPane = $(".t-pane:first", splitter.element);

                equals(splitter.max(firstPane), "200px");

                splitter.max(firstPane, "120px");

                equals(splitter.max(firstPane), "120px");
            });

            test("size(value) triggers resize", function() {
                var triggered = false,
                splitter = $(getSplitterHtml())
                .appendTo(document.body)
                .kendoSplitter({
                    panes: [ { size: "110px" }, {} ]
                })
                .data("kendoSplitter")
                .bind("resize", function() {
                    triggered = true;
                });

                splitter.size(".t-pane:first", "120px");

                ok(triggered);
            });
        </script>
        <div id="qunit-fixture">test markup, will be hidden</div>
        <ul id="log"></ul>
    </body>
</html>
