<!DOCTYPE html>
<html>
    <head>
        <title>Splitter client initialization</title>
        <script src="../jquery-loader.js"></script>
        <script src="../qunit/qunit/qunit.js"></script>
        <script src="../kendo-test-helpers.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.userevents.js"></script>
        <script src="../../src/kendo.draganddrop.js"></script>
        <script src="../../src/kendo.resizable.js"></script>
        <script src="../../src/kendo.splitter.js"></script>
        <script src="helper.js"></script>
        <link rel="stylesheet" href="../qunit/qunit/qunit.css" />

        <link rel="stylesheet" href="../../styles/web/kendo.common.css">
        <link rel="stylesheet/less" href="../../styles/web/kendo.default.less">

        <script src="../../demos/mvc/content/shared/js/less.js"></script>
    </head>
    <body>
        <h1 id="qunit-header">Splitter client initialization</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <script>

            module("initialization", {
                teardown: function() {
                    $(".k-splitter").remove();
                }
            });
            test("constructor adds classes to container", function() {
                var splitter = $(getSplitterHtml(1)).kendoSplitter();

                ok(splitter.hasClass("k-widget"));
                ok(splitter.hasClass("k-splitter"));

                splitter = $(getSplitterHtml(1)).kendoSplitter({ orientation: "vertical" });

                ok(splitter.hasClass("k-splitter"));
            });

            test("constructor interprets erronious orientation as horizontal", function() {
                var splitter = $(getSplitterHtml(1)).kendoSplitter({ orientation: "diagonal" });

                ok(splitter.hasClass("k-splitter"));
            });

            test("init adds classes to child elements", function() {
                var splitter = $(getSplitterHtml(1)).kendoSplitter();

                equal(splitter.find(".k-pane").length, 1);
            });

            test("init adds splitbars between panes", function() {
                var splitter = $(getSplitterHtml(3)).kendoSplitter(),
                splitbars = splitter.find(".k-splitbar");

                equal(splitbars.length, 2);
                equal(splitbars.eq(0).index(), 1);
                equal(splitbars.eq(1).index(), 3);
                equal(splitbars.attr("tabindex"), 0);
            });

            test("splitbars have collapse button for collapsible panes", function() {
                var splitter = $(getSplitterHtml(3)).kendoSplitter({
                    panes: [
                    { collapsible: true },
                    {},
                    { collapsible: true }
                    ]
                }),
                splitbars = splitter.find(".k-splitbar");

                equal(splitbars.eq(0).find(".k-icon.k-collapse-prev").length, 1);
                equal(splitbars.eq(1).find(".k-icon.k-collapse-next").length, 1);
            });

            test("splitbars have resize handle between resizable panes", function() {
                var splitter = $(getSplitterHtml(3))
                .kendoSplitter({
                    panes: [
                    { resizable: false },
                    {},
                    {}
                    ]
                }),
                splitbars = splitter.find(".k-splitbar");

                equal(splitbars.eq(0).find(".k-icon.k-resize-handle").length, 0);
                equal(splitbars.eq(1).find(".k-icon.k-resize-handle").length, 1);
            });

            test("collapsed panes render expand arrow beside them", function() {
                var splitter = $(getSplitterHtml())
                .kendoSplitter({
                    panes: [
                    { collapsible: true, collapsed: true },
                    {}
                    ]
                });

                equal(splitter.find(".k-expand-prev").length, 1);
            });

            test("splibars next to initially collapsed panes are not draggable", function() {
                var splitter = $(getSplitterHtml())
                .kendoSplitter({
                    panes: [
                    { collapsible: true, collapsed: true },
                    {}
                    ]
                });

                ok(!splitter.find(".k-splitbar").hasClass("k-splitbar-draggable-horizontal"));
            });

            test("panes get k-scrollable class if they are scrollable", function() {
                var splitter = $(getSplitterHtml())
                .kendoSplitter({
                    panes: [
                    { scrollable: false },
                    {}
                    ]
                }),
                panes = splitter.find(".k-pane");

                ok(!panes.eq(0).hasClass("k-scrollable"));
                ok(panes.eq(1).hasClass("k-scrollable"));
            });

            test("inner splitters get resized after initialization of outer splitters", function() {
                var outerSplitter = $("<div id='outerSplitter' class='k-splitter' style='height:107px'><div /><div /></div>")
                        .appendTo("body"),
                    innerSplitter = $("<div id='innerSplitter' style='height:100%'><div /><div /></div>")
                        .appendTo(outerSplitter.find("div:first"));

                innerSplitter.kendoSplitter({
                    orientation: "vertical"
                });
                outerSplitter.kendoSplitter({
                    orientation: "horizontal"
                });

                equal(innerSplitter.find(">div:first").height(), 50)
            });

            test("initialization filters out script blocks", function() {
                var dom = $("<div><div /><div /><script><\/script></div>");

                dom.kendoSplitter();

                equal(dom.find(".k-pane").length, 2);
            });
        </script>
        <div id="qunit-fixture">test markup, will be hidden</div>
        <ul id="log"></ul>
    </body>
</html>
