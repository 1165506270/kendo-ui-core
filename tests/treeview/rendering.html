<!DOCTYPE html>
<html>
    <head>
        <title>TreeView Rendering</title>
        <script src="../../src/jquery.js"></script>
        <script src="../qunit.js"></script>
        <script src="../qunit-runner.js"></script>
        <script src="../../src/kendo.core.js"></script>
        <script src="../../src/kendo.query.js"></script>
        <script src="../../src/kendo.datasource.js"></script>
        <script src="../../src/kendo.treeview.js"></script>
        <link rel="stylesheet" href="../qunit.css" />
    </head>
    <body>
        <h1 id="qunit-header">TreeView Rendering</h1>
        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <script>
            var TreeView = kendo.ui.TreeView,
                DataSource = kendo.data.DataSource;

            module("getGroupHtml");

            test("renders empty group when there are no items", function() {
                var html = TreeView.getGroupHtml({
                    items: [],
                    treeview: {},
                    group: {
                        isExpanded: true
                    }
                });

                equal(html, "<ul class='t-group'></ul>");
            });

            test("renders lines class for first level", function() {
                var html = TreeView.getGroupHtml({ 
                    items: [],
                    group: {
                        isFirstLevel: true,
                        isExpanded: true
                    }
                });

                equal(html, "<ul class='t-group t-treeview-lines'></ul>");
            });

            test("renders hidden group if it is not expanded", function() {
                var html = TreeView.getGroupHtml({
                    items: [],
                    group: {
                        isExpanded: false
                    }
                });

                equal(html, "<ul class='t-group' style='display:none'></ul>");
            });
            
//        kendo.ui.var $item = $(TreeView.getItemHtml({
//            item: data[i],
//            isAjax: options.isAjax,
//            isFirstLevel: isFirstLevel,
//            showCheckBoxes: options.showCheckBoxes,
//            groupLevel: options.groupLevel,
//            itemIndex: options.i,
//            itemsCount: options.len,
//            elementId: options.elementId
//        });

            module("getItemHtml");

            test("renders of links for items with NavigateUrl", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        url: "http://kendoui.com/"
                    }
                }));

                equal($item.find("a[href='http://kendoui.com/']").length, 1);
            });

            test("renders disabled state on disabled items", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        enabled: false
                    }
                }));

                equal($item.find(".t-in.t-state-disabled").length, 1);
            });

            test("renders selected state on selected items", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        selected: true
                    }
                }));

                equal($item.find(".t-in.t-state-selected").length, 1);
            });

            test("renders collapsed subgroups by default", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "Collapsed",
                        items: [
                            { text: "Should not be visible" }
                        ]
                    }
                }));
                
                equal($item.find(".t-group").css("display"), "none");
            });


            test("renders spriteCssClass", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        spriteCssClass: "cssClass1"
                    }
                }));

                equal($item.find('.t-sprite').length, 1);
                ok($item.find('.t-sprite').hasClass('cssClass1'));
            });

            test("renders images", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        imageUrl: "foo"
                    }
                }));

                var image = $item.find(".t-image");

                equal(image.length, 1);
                equal(image.attr("src"), "foo");
            });

            test("renders item value", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        value: "foo"
                    }
                }));

                var input = $item.find(".t-input");

                equal(input.length, 1);
                equal(input.val(), "foo");
                equal(input.attr("type"), "hidden");
            });

            test("renders text", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "foo"
                    }
                }));

                equal($item.text(), "foo");
            });

            test("renders text encoded", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "foo>>"
                    }
                }));

                equal($item.text(), "foo>>");
            });

            test("renders encoded text as html", function() {
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "<span class='foo'></span>",
                        encoded: false
                    }
                }));

                equal($item.find(".foo").length, 1);
            });
/*
            module("Rendering / Checkboxes");

            test("getItemHtml should render span wrapper for the checkNodes", function() {
                
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true
                    }
                }));

                equal($item.find('> div > .t-checkbox').length, 1, 'Does not render checkbox group wrapper');
            });

            test("getItemHtml should render checkbox and hidden input", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true
                    },
                    showCheckBoxes: true
                }));

                equal($item.find('.t-input[type="hidden"]').length, 1);
                equal($item.find('.t-input[type="checkbox"]').length, 1);
            });

            test("getItemHtml should render hidden input with name attr in checkbox wrapper", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true
                    },
                    treeview: {
                        showCheckBoxes: true,
                        id: "TreeView1"
                    }
                }));

                equal($item.find('.t-input[type="hidden"]').attr('name'), "TreeView1_checkedNodes.Index");
            });

            test("getItemHtml should render hidden input in checkbox wrapper with value 0 if it is first level", function() {
                
                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true,
                        index: 0
                    },
                    treeview: {
                        showCheckBoxes: true,
                        id: "TreeView1"
                    },
                    group: {
                        level: ""
                    }
                }));

                equal($item.find('.t-input[type="hidden"]').attr('value'), "0");
            });

            test("getItemHtml should render hidden input in checkbox wrapper with value created by group level", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true,
                        index: 2
                    },
                    treeview: {
                        showCheckBoxes: true,
                        id: "TreeView1"
                    },
                    group: {
                        level: "1:0"
                    }
                }));

                equal($item.find('.t-input[type="hidden"]').attr('value'), "1:0:2");
            });

            test("getItemHtml should render checkbox input with name attr", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true,
                        index: 0
                    },
                    showCheckBoxes: true,
                    elementId: "TreeView1",
                    groupLevel: "0"
                }));

                equal($item.find('.t-input[type="checkbox"]').attr('name'), "TreeView1_checkedNodes[0:0].Checked");
            });

            test("getItemHtml should render checkbox input with value true if item is checked", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true,
                        Checked: true
                    },
                    isAjax: false,
                    isFirstLevel: false,
                    showCheckBoxes: true,
                    itemIndex: 0,
                    itemsCount: 1,
                    elementId: "TreeView1",
                    groupLevel: "0"
                }));

                equal($item.find('.t-input[type="checkbox"]').attr('value'), "True");
            });

            test("getItemHtml should render disabled checkbox with disabled state class", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true,
                        Checked: true,
                        Enabled: false
                    },
                    isAjax: false,
                    isFirstLevel: false,
                    showCheckBoxes: true,
                    itemIndex: 0,
                    itemsCount: 1,
                    elementId: "TreeView1",
                    groupLevel: "0"
                }));

                equal($item.find('.t-input[type="checkbox"]').attr('disabled'), true);
            });

            test("getItemHtml should render checked checkbox Checked property is true", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Checkable: true,
                        Checked: true
                    },
                    isAjax: false,
                    isFirstLevel: false,
                    showCheckBoxes: true,
                    itemIndex: 0,
                    itemsCount: 1,
                    elementId: "TreeView1",
                    groupLevel: "0"
                }));

                equal($item.find('[type=checkbox]').attr('checked'), true);
            });

            test("getItemHtml should render hidden inputs containing dataItem values if item is checked", function() {

                var $item = $(TreeView.getItemHtml({
                    item: {
                        text: "text",
                        Value: "1",
                        Checkable: true,
                        Checked: true
                    },
                    isAjax: false,
                    isFirstLevel: false,
                    showCheckBoxes: true,
                    itemIndex: 0,
                    itemsCount: 1,
                    elementId: "TreeView1",
                    groupLevel: "0"
                }));

                equal($item.find('[type=hidden]').eq(1).val(), "1");
                equal($item.find('[type=hidden]').eq(2).val(), "text");
            });
*/
        </script>

        <div id="qunit-fixture">test markup, will be hidden</div>
        <ul id="log"></ul>
    </body>
</html>
